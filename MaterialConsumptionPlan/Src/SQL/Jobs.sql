---To Create a useful tools for analyse pre-demand and supplier capacity.
---All plants
--'5041', '5051', '5101', '5111', '5121', '5161', '5191', '5201','5071','5141'
--'||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||'
--'5041', '5051', '5101', '5111', '5121', '5161', '5191', '5201','5071','5141'
--'5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140'

---INI SETUP
DROP TABLE INV_SAP_MATERIAL_CATALOG;
CREATE TABLE INV_SAP_MATERIAL_CATALOG AS SELECT * FROM DWQ$LIBRARIAN.INV_SAP_MATERIAL_CATALOG@ROCKWELL_DBLINK;

DROP TABLE INV_SAP_SHIP_SOLD_TO_PARTYID;
CREATE TABLE INV_SAP_SHIP_SOLD_TO_PARTYID AS SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SHIP_SOLD_TO_PARTYID@ROCKWELL_DBLINK;

DROP TABLE INV_SAP_PP_MVKE;
CREATE TABLE INV_SAP_PP_MVKE AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK WHERE DIRECT_SHIP_PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

Drop table INV_SAP_PP_OPTIMIZATION;
CREATE TABLE INV_SAP_PP_OPTIMIZATION AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID IN ('5041', '5051', '5101', '5111', '5121', '5161', '5191', '5201','5071','5141'); 

Drop table INV_SAP_SALES_VBAK_VBAP_VBUP;
CREATE TABLE INV_SAP_SALES_VBAK_VBAP_VBUP AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_VBAK_VBAP_VBUP@ROCKWELL_DBLINK WHERE PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DROP TABLE INV_SAP_PP_FRCST_PBIM_PBED;
CREATE TABLE INV_SAP_PP_FRCST_PBIM_PBED AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DROP TABLE INV_SAP_SALES_HST;
CREATE TABLE INV_SAP_SALES_HST AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DROP TABLE INV_SAP_PP_PO_HISTORY;
CREATE TABLE INV_SAP_PP_PO_HISTORY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_PO_HISTORY@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DROP TABLE INV_SAP_LIKP_LIPS_DAILY;
CREATE TABLE INV_SAP_LIKP_LIPS_DAILY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_LIKP_LIPS_DAILY@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DROP TABLE INV_SAP_INVENTORY_BY_PLANT;
CREATE TABLE INV_SAP_INVENTORY_BY_PLANT AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_INVENTORY_BY_PLANT@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');


--Weekly
--Catalog#
DECLARE
  CREATE_TABLE_INV_SAP_MATERIAL_CATALOG        VARCHAR2(1000);
  DROP_TABLE_INV_SAP_MATERIAL_CATALOG              VARCHAR2(1000);
BEGIN
  DROP_TABLE_INV_SAP_MATERIAL_CATALOG:= 'DROP TABLE INV_SAP_MATERIAL_CATALOG';
  CREATE_TABLE_INV_SAP_MATERIAL_CATALOG       := 'CREATE TABLE INV_SAP_MATERIAL_CATALOG AS SELECT * FROM DWQ$LIBRARIAN.INV_SAP_MATERIAL_CATALOG@ROCKWELL_DBLINK';
  EXECUTE IMMEDIATE DROP_TABLE;
  EXECUTE IMMEDIATE STR_CREATE_TABLE;
END;

--DWQ$LIBRARIAN.INV_SAP_SHIP_SOLD_TO_PARTYID@ROCKWELL_DBLINK
DECLARE
  CREATE_TABLE_SOLD_TO_PARTYID VARCHAR2(1000);
  DROP_TABLE_SOLD_TO_PARTYID   VARCHAR2(1000);
BEGIN
  DROP_TABLE_SOLD_TO_PARTYID   := 'DROP TABLE INV_SAP_SHIP_SOLD_TO_PARTYID';
  CREATE_TABLE_SOLD_TO_PARTYID := 'CREATE TABLE INV_SAP_SHIP_SOLD_TO_PARTYID AS SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SHIP_SOLD_TO_PARTYID@ROCKWELL_DBLINK';
  EXECUTE IMMEDIATE DROP_TABLE_SOLD_TO_PARTYID;
  EXECUTE IMMEDIATE CREATE_TABLE_SOLD_TO_PARTYID;
END;

--DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
DROP TABLE INV_SAP_PP_MVKE;
CREATE TABLE INV_SAP_PP_MVKE AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK WHERE DIRECT_SHIP_PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_INV_SAP_PP_MVKE   VARCHAR2(1000);
  CREATE_TABLE_INV_SAP_PP_MVKE VARCHAR2(1000);
BEGIN
  DROP_TABLE_INV_SAP_PP_MVKE   := 'DROP TABLE INV_SAP_PP_MVKE';
  CREATE_TABLE_INV_SAP_PP_MVKE := 'CREATE TABLE INV_SAP_PP_MVKE AS SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK WHERE DIRECT_SHIP_PLANT IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_INV_SAP_PP_MVKE;
  EXECUTE IMMEDIATE CREATE_TABLE_INV_SAP_PP_MVKE;
END;

--Basic Tables Update Every day
 
--DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK
Drop table INV_SAP_PP_OPTIMIZATION;
CREATE TABLE INV_SAP_PP_OPTIMIZATION AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID IN ('5041', '5051', '5101', '5111', '5121', '5161', '5191', '5201','5071','5141'); 

DECLARE
  DROP_TABLE_PP_OPTIMIZATION   VARCHAR2(1000);
  CREATE_TABLE_PP_OPTIMIZATION VARCHAR2(1000);
BEGIN
  DROP_TABLE_PP_OPTIMIZATION   := 'DROP TABLE INV_SAP_PP_OPTIMIZATION';
  CREATE_TABLE_PP_OPTIMIZATION := 'CREATE TABLE INV_SAP_PP_OPTIMIZATION AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID IN ('||5041||', '||5051||', '||5101||', '||5111||', '||5121||', '||5161||', '||5191||', '||5201||','||5071||','||5141||')';
  EXECUTE IMMEDIATE DROP_TABLE_PP_OPTIMIZATION;
  EXECUTE IMMEDIATE CREATE_TABLE_PP_OPTIMIZATION;
END;

--ALL
SELECT COUNT(*) FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK;
DECLARE
  DROP_TABLE_PP_OPTIMIZATION   VARCHAR2(1000);
  CREATE_TABLE_PP_OPTIMIZATION VARCHAR2(1000);
BEGIN
  DROP_TABLE_PP_OPTIMIZATION   := 'DROP TABLE INV_SAP_PP_OPTIMIZATION';
  CREATE_TABLE_PP_OPTIMIZATION := 'CREATE TABLE INV_SAP_PP_OPTIMIZATION AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK';
  EXECUTE IMMEDIATE DROP_TABLE_PP_OPTIMIZATION;
  EXECUTE IMMEDIATE CREATE_TABLE_PP_OPTIMIZATION;
END;

--DWQ$LIBRARIAN.INV_SAP_SALES_VBAK_VBAP_VBUP@ROCKWELL_DBLINK
Drop table INV_SAP_SALES_VBAK_VBAP_VBUP;
CREATE TABLE INV_SAP_SALES_VBAK_VBAP_VBUP AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_VBAK_VBAP_VBUP@ROCKWELL_DBLINK WHERE PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_OPEN_SALES   VARCHAR2(1000);
  CREATE_TABLE_OPEN_SALES  VARCHAR2(1000);
BEGIN
  DROP_TABLE_OPEN_SALES   := 'Drop table INV_SAP_SALES_VBAK_VBAP_VBUP';
  CREATE_TABLE_OPEN_SALES := 'CREATE TABLE INV_SAP_SALES_VBAK_VBAP_VBUP AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_VBAK_VBAP_VBUP@ROCKWELL_DBLINK WHERE PLANT IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_OPEN_SALES;
  EXECUTE IMMEDIATE CREATE_TABLE_OPEN_SALES;
END;

--DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK
DROP TABLE INV_SAP_PP_FRCST_PBIM_PBED;
CREATE TABLE INV_SAP_PP_FRCST_PBIM_PBED AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_OPEN_FC   VARCHAR2(1000);
  CREATE_TABLE_OPEN_FC  VARCHAR2(1000);
BEGIN
  DROP_TABLE_OPEN_FC   := 'Drop table INV_SAP_PP_FRCST_PBIM_PBED';
  CREATE_TABLE_OPEN_FC := 'CREATE TABLE INV_SAP_PP_FRCST_PBIM_PBED AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK WHERE PLANTID IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_OPEN_FC;
  EXECUTE IMMEDIATE CREATE_TABLE_OPEN_FC;
END;


--DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
DROP TABLE INV_SAP_SALES_HST;
CREATE TABLE INV_SAP_SALES_HST AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_SALES_HST  VARCHAR2(1000);
  CREATE_TABLE_SALES_HST  VARCHAR2(1000);
BEGIN
  DROP_TABLE_SALES_HST   := 'Drop table INV_SAP_SALES_HST';
  CREATE_TABLE_SALES_HST := 'CREATE TABLE INV_SAP_SALES_HST AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK WHERE PLANTID IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_SALES_HST;
  EXECUTE IMMEDIATE CREATE_TABLE_SALES_HST;
END;


--DWQ$LIBRARIAN.INV_SAP_PP_PO_HISTORY@ROCKWELL_DBLINK
DROP TABLE INV_SAP_PP_PO_HISTORY;
CREATE TABLE INV_SAP_PP_PO_HISTORY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_PO_HISTORY@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_PP_PO_HISTORY  VARCHAR2(1000);
  CREATE_TABLE_PP_PO_HISTORY  VARCHAR2(1000);
BEGIN
  DROP_TABLE_PP_PO_HISTORY   := 'Drop table INV_SAP_PP_PO_HISTORY';
  CREATE_TABLE_PP_PO_HISTORY := 'CREATE TABLE INV_SAP_PP_PO_HISTORY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_PO_HISTORY@ROCKWELL_DBLINK WHERE PLANTID IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_PP_PO_HISTORY;
  EXECUTE IMMEDIATE CREATE_TABLE_PP_PO_HISTORY;
END;

--DWQ$LIBRARIAN.INV_SAP_LIKP_LIPS_DAILY@ROCKWELL_DBLINK
DROP TABLE INV_SAP_LIKP_LIPS_DAILY;
CREATE TABLE INV_SAP_LIKP_LIPS_DAILY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_LIKP_LIPS_DAILY@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_DELIVERY_REC  VARCHAR2(1000);
  CREATE_TABLE_DELIVERY_REC  VARCHAR2(1000);
BEGIN
  DROP_TABLE_DELIVERY_REC   := 'Drop table INV_SAP_LIKP_LIPS_DAILY';
  CREATE_TABLE_DELIVERY_REC := 'CREATE TABLE INV_SAP_LIKP_LIPS_DAILY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_LIKP_LIPS_DAILY@ROCKWELL_DBLINK WHERE PLANTID IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_DELIVERY_REC;
  EXECUTE IMMEDIATE CREATE_TABLE_DELIVERY_REC;
END;

--DWQ$LIBRARIAN.INV_SAP_INVENTORY_BY_PLANT@ROCKWELL_DBLINK
DROP TABLE INV_SAP_INVENTORY_BY_PLANT;
CREATE TABLE INV_SAP_INVENTORY_BY_PLANT AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_INVENTORY_BY_PLANT@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  DROP_TABLE_INVENTORY_REC  VARCHAR2(1000);
  CREATE_TABLE_INVENTORY_REC  VARCHAR2(1000);
BEGIN
  DROP_TABLE_INVENTORY_REC   := 'Drop table INV_SAP_INVENTORY_BY_PLANT';
  CREATE_TABLE_INVENTORY_REC := 'CREATE TABLE INV_SAP_INVENTORY_BY_PLANT AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_INVENTORY_BY_PLANT@ROCKWELL_DBLINK WHERE PLANTID IN ('||5040||', '||5050||', '||5100||', '||5110||', '||5120||', '||5160||', '||5190||', '||5200||','||5070||','||5140||')';
  EXECUTE IMMEDIATE DROP_TABLE_INVENTORY_REC;
  EXECUTE IMMEDIATE CREATE_TABLE_INVENTORY_REC;
END;


--FUNCTION COLLECTIONS
-----Catalog Table Remove Dash
SELECT * FROM INV_SAP_NODASH_MAT_CATA;

DECLARE
  DROP_TABLE_CATANODSH   VARCHAR2(1000);
  CREATE_TABLE_CATANODSH VARCHAR2(1000);
BEGIN
  DROP_TABLE_CATANODSH   := 'DROP TABLE INV_SAP_NODASH_MAT_CATA';
  CREATE_TABLE_CATANODSH := 'CREATE TABLE INV_SAP_NODASH_MAT_CATA AS SELECT * FROM INV_SAP_MATERIAL_CATALOG';
  EXECUTE IMMEDIATE DROP_TABLE_INVENTORY_REC;
  EXECUTE IMMEDIATE CREATE_TABLE_CATANODSH;
END;
  
DECLARE
  CURSOR cur
  IS
    SELECT a.CATALOG_STRING1,
      b.ROWID ROW_ID
    FROM INV_SAP_MATERIAL_CATALOG a,
      INV_SAP_NODASH_MAT_CATA b
    WHERE a.MATERIALID = b.MATERIALID
    ORDER BY b.ROWID; ---order by rowid
  V_COUNTER NUMBER;
BEGIN
  V_COUNTER := 0;
  FOR row IN cur
  LOOP
    UPDATE INV_SAP_NODASH_MAT_CATA SET CATALOG_STRING2 = REPLACE(row.CATALOG_STRING1, '-') WHERE ROWID = row.ROW_ID;
    V_COUNTER     := V_COUNTER + 1;
    IF (V_COUNTER >= 1000) THEN
      COMMIT;
      V_COUNTER := 0;
    END IF;
  END LOOP;
  COMMIT;
END;




----------------------------------------------------VIEWS---------------------------------------------------------------
--VIEW COLLECTIONS
----X CURRENT ITEM VIEW
DROP VIEW VIEW_INV_SAP_ITEM_X;
SELECT * FROM VIEW_INV_SAP_ITEM_X;
CREATE VIEW VIEW_INV_SAP_ITEM_X AS 
SELECT DISTINCT * FROM
(SELECT ISPM.ID           AS ID,
  ISPM.DIRECT_SHIP_PLANT AS PLANT,
  ISPM.MATERIALID        AS MATERIAL,
  ISMC.CATALOG_STRING1   AS CATALOG_DASH,
  ISMC.CATALOG_STRING2   AS CATALOG_NO_DASH,
  ISPM.DIST_CHL          AS DIST_CHL,
  ISPM.STOCK_STATUS      AS STOCK_STATUS,
  ISPM.CURRENT_SERIES    AS CURRENT_SERIES
FROM
  (SELECT MATERIALID
    ||'_'
    ||DIRECT_SHIP_PLANT AS ID,
    MATERIALID,
    DIST_CHL,
    DIRECT_SHIP_PLANT,
    STOCK_STATUS,
    CURRENT_SERIES
  FROM INV_SAP_PP_MVKE
  WHERE CURRENT_SERIES = 'X'
  )ISPM
LEFT JOIN
  (SELECT CATALOG_STRING1,
    CATALOG_STRING2,
    MATERIALID
  FROM INV_SAP_NODASH_MAT_CATA
  )ISMC
ON ISPM.MATERIALID = ISMC.MATERIALID); --WHERE ID = '80026-146-56-R_5200';

--ITEM ALL
CREATE VIEW VIEW_INV_SAP_ITEM_ALL AS 
SELECT ISPM.ID           AS ID,
  ISPM.DIRECT_SHIP_PLANT AS PLANT,
  ISPM.MATERIALID        AS MATERIAL,
  ISMC.CATALOG_STRING1   AS CATALOG_DASH,
  ISMC.CATALOG_STRING2   AS CATALOG_NO_DASH,
  ISPM.SALES_ORG         AS SALES_ORG,
  ISPM.DIST_CHL          AS DIST_CHL,
  ISPM.D_CHAIN_BLK       AS D_CHAIN_BLK,
  ISPM.VALID_FROM_DATE   AS VALID_FROM_DATE,
  ISPM.STOCK_STATUS      AS STOCK_STATUS,
  ISPM.CURRENT_SERIES    AS CURRENT_SERIES
FROM
  (SELECT MATERIALID
    ||'_'
    ||DIRECT_SHIP_PLANT AS ID,
    MATERIALID,
    SALES_ORG,
    DIST_CHL,
    D_CHAIN_BLK,
    VALID_FROM_DATE,
    DIRECT_SHIP_PLANT,
    STOCK_STATUS,
    CURRENT_SERIES
  FROM INV_SAP_PP_MVKE
  )ISPM
LEFT JOIN
  (SELECT CATALOG_STRING1,
    CATALOG_STRING2,
    MATERIALID
  FROM INV_SAP_NODASH_MAT_CATA
  )ISMC
ON ISPM.MATERIALID = ISMC.MATERIALID;

----PP TABLE BASIC_INFO
--CURRENT ITEM
DROP VIEW VIEW_INV_SAP_PP_OPT_X;
SELECT * FROM VIEW_INV_SAP_PP_OPT_X;
CREATE VIEW VIEW_INV_SAP_PP_OPT_X AS
SELECT *
FROM
  (SELECT PP_BASIC.ID,
    PP_BASIC.LAST_REVIEW,
    PP_BASIC.MATERIAL,
    ITEM_X.CATALOG_DASH,
    ITEM_X.CATALOG_NO_DASH,
    PP_BASIC.PLANT,
    PP_BASIC.MAT_DESC,
    PP_BASIC.SAFETY_STOCK,
    PP_BASIC.OH_QTY,
    PP_BASIC.UNIT,
    PP_BASIC.UNIT_COST,
    PP_BASIC.OH_QTY_INTRANSIT,
    PP_BASIC.PROD_BU,
    PP_BASIC.PROD_FAM,
    PP_BASIC.PROC_TYPE,
    PP_BASIC.STRATEGY_GRP,
    PP_BASIC.MRP_TYPE,
    PP_BASIC.PROD_SCHEDULER,
    PP_BASIC.PLANT_SP_MATL_STA,
    PP_BASIC.VENDOR_KEY,
    PP_BASIC.VENDOR_ITEM,
    PP_BASIC.MIN_INV,
    PP_BASIC.TARGET_INV,
    PP_BASIC.MAX_INV,
    PP_BASIC.LOT_SIZE_QTY,
    PP_BASIC.LOT_ROUNDING_VALUE,
    PP_BASIC.LOT_SIZE_DISLS,
    PP_BASIC.AVG26_USAGE_QTY,
    PP_BASIC.STDEV26_USAGE,
    PP_BASIC.AVG13_USAGE_QTY,
    PP_BASIC.STDEV13_USAGE,
    PP_BASIC.Q1_LINES,
    PP_BASIC.Q2_LINES,
    PP_BASIC.Q3_LINES,
    PP_BASIC.Q4_LINES,
    PP_BASIC.Q1_FREQ_COUNT,
    PP_BASIC.Q2_FREQ_COUNT,
    PP_BASIC.Q3_FREQ_COUNT,
    PP_BASIC.Q4_FREQ_COUNT,
    PP_BASIC.EXCHANGE_RATE,
    PP_BASIC.LEVEL_TYPE,
    PP_BASIC.MATERIAL_LEVEL_VALUE,
    PP_BASIC.MRP_CONTROLLER,
    PP_BASIC.MRP_CONTROLLER_KEY,
    PP_BASIC.PURCH_GROUP,
    PP_BASIC.PURCH_GROUP_KEY,
    PP_BASIC.PROD_SCHED_KEY,
    PP_BASIC.RECORDER_POINT,
    PP_BASIC.LEAD_TIME,
    ITEM_X.DIST_CHL,
    ITEM_X.STOCK_STATUS,
    PP_BASIC.ISSUE_UOM_NUMERATOR,
    PP_BASIC.PO_UOM_NUMERATOR,
    PP_BASIC.MATL_TYPE,
    ITEM_X.CURRENT_SERIES,
    PP_BASIC.ULTIMATE_SOURCE
  FROM
    (SELECT MATERIALID
      ||'_'
      ||(PLANTID - 1) AS ID,
      LAST_REVIEW,
      MATERIALID    AS MATERIAL,
      (PLANTID - 1) AS PLANT,
      MAT_DESC,
      SAFETY_STK AS SAFETY_STOCK,
      OH_QTY,
      UNIT_COST,
      OH_QTY_INTRANSIT,
      SUBSTR(PROD_BU,0,3) AS PROD_BU,
      PROD_FAM,
      PROC_TYPE,
      STRATEGY_GRP,
      MRP_TYPE,
      PROD_SCHEDULER,
      SP_MATL_STAT_MMSTA AS PLANT_SP_MATL_STA,
      SPC_PROC_KEY_SOBSL AS VENDOR_KEY,
      MATERIALID
      ||'_'
      ||SUBSTR(VENDOR_NAME,0,4)           AS VENDOR_ITEM,
      (SAFETY_STK)                        AS MIN_INV,
      CEIL(SAFETY_STK + 0.5*LOT_SIZE_QTY) AS TARGET_INV,
      CEIL(SAFETY_STK + 0.5*LOT_SIZE_QTY) AS MAX_INV,
      LOT_SIZE_QTY,
      LOT_ROUNDING_VALUE,
      LOT_SIZE_DISLS,
      AVG26_USAGE_QTY,
      STDEV26_USAGE,
      AVG13_USAGE_QTY,
      STDEV13_USAGE,
      Q1_LINES,
      Q2_LINES,
      Q3_LINES,
      Q4_LINES,
      Q1_FREQ_COUNT,
      Q2_FREQ_COUNT,
      Q3_FREQ_COUNT,
      Q4_FREQ_COUNT,
      EXCHANGE_RATE,
      LEVEL_TYPE,
      MATERIAL_LEVEL_VALUE,
      MRP_CONTROLLER,
      MRP_CONTROLLER_DISPO AS MRP_CONTROLLER_KEY,
      PURCH_GROUP,
      PURCH_GROUP_EKGRP AS PURCH_GROUP_KEY,
      PROD_SCHED_FEVOR  AS PROD_SCHED_KEY,
      REORDER_PT        AS RECORDER_POINT,
      (GRT + PDT + 1)   AS LEAD_TIME,
      MEINS_ISSUE_UOM   AS UNIT,
      ISSUE_UOM_NUMERATOR,
      PO_UOM_NUMERATOR,
      MATL_TYPE_MTART AS MATL_TYPE,
      ULTIMATE_SOURCE
    FROM INV_SAP_PP_OPTIMIZATION
    )PP_BASIC
  LEFT JOIN
    (SELECT ID,
      MATERIAL,
      CATALOG_DASH,
      CATALOG_NO_DASH,
      DIST_CHL,
      STOCK_STATUS,
      CURRENT_SERIES
    FROM VIEW_INV_SAP_ITEM_X
    )ITEM_X
  ON ITEM_X.ID = PP_BASIC.ID
  )
WHERE CURRENT_SERIES = 'X';

--VIEW_INV_SAP_PP_OPT_ALL INCLUDE NON-CURRENT ITEM, LOOK LIKE UNDER DEV ETC.
DROP VIEW VIEW_INV_SAP_PP_OPT_ALL;
CREATE VIEW VIEW_INV_SAP_PP_OPT_ALL AS
SELECT PP_BASIC.ID,
  PP_BASIC.LAST_REVIEW,
  PP_BASIC.MATERIAL,
  ITEM_X.CATALOG_DASH,
  ITEM_X.CATALOG_NO_DASH,
  ITEM_X.D_CHAIN_BLK,
  ITEM_X.CURRENT_SERIES,
  PP_BASIC.PLANT,
  ITEM_X.SALES_ORG,
  PP_BASIC.MAT_DESC,
  PP_BASIC.SAFETY_STOCK,
  PP_BASIC.OH_QTY,
  PP_BASIC.UNIT,
  PP_BASIC.UNIT_COST,
  PP_BASIC.OH_QTY_INTRANSIT,
  PP_BASIC.PROD_BU,
  PP_BASIC.PROD_FAM,
  PP_BASIC.PROC_TYPE,
  PP_BASIC.STRATEGY_GRP,
  PP_BASIC.MRP_TYPE,
  PP_BASIC.PROD_SCHEDULER,
  PP_BASIC.PLANT_SP_MATL_STA,
  PP_BASIC.VENDOR_KEY,
  PP_BASIC.VENDOR_ITEM,
  PP_BASIC.MIN_INV,
  PP_BASIC.TARGET_INV,
  PP_BASIC.MAX_INV,
  PP_BASIC.LOT_SIZE_QTY,
  PP_BASIC.LOT_ROUNDING_VALUE,
  PP_BASIC.LOT_SIZE_DISLS,
  PP_BASIC.AVG26_USAGE_QTY,
  PP_BASIC.STDEV26_USAGE,
  PP_BASIC.AVG13_USAGE_QTY,
  PP_BASIC.STDEV13_USAGE,
  PP_BASIC.Q1_LINES,
  PP_BASIC.Q2_LINES,
  PP_BASIC.Q3_LINES,
  PP_BASIC.Q4_LINES,
  PP_BASIC.Q1_FREQ_COUNT,
  PP_BASIC.Q2_FREQ_COUNT,
  PP_BASIC.Q3_FREQ_COUNT,
  PP_BASIC.Q4_FREQ_COUNT,
  PP_BASIC.EXCHANGE_RATE,
  PP_BASIC.LEVEL_TYPE,
  PP_BASIC.MATERIAL_LEVEL_VALUE,
  PP_BASIC.MRP_CONTROLLER,
  PP_BASIC.MRP_CONTROLLER_KEY,
  PP_BASIC.PURCH_GROUP,
  PP_BASIC.PURCH_GROUP_KEY,
  PP_BASIC.PROD_SCHED_KEY,
  PP_BASIC.RECORDER_POINT,
  PP_BASIC.LEAD_TIME,
  ITEM_X.DIST_CHL,
  ITEM_X.STOCK_STATUS,
  PP_BASIC.ISSUE_UOM_NUMERATOR,
  PP_BASIC.PO_UOM_NUMERATOR,
  PP_BASIC.MATL_TYPE,
  PP_BASIC.ULTIMATE_SOURCE
FROM
  (SELECT MATERIALID
    ||'_'
    ||(PLANTID - 1) AS ID,
    LAST_REVIEW,
    MATERIALID    AS MATERIAL,
    (PLANTID - 1) AS PLANT,
    MAT_DESC,
    SAFETY_STK AS SAFETY_STOCK,
    OH_QTY,
    UNIT_COST,
    OH_QTY_INTRANSIT,
    SUBSTR(PROD_BU,0,3) AS PROD_BU,
    PROD_FAM,
    PROC_TYPE,
    STRATEGY_GRP,
    MRP_TYPE,
    PROD_SCHEDULER,
    SP_MATL_STAT_MMSTA AS PLANT_SP_MATL_STA,
    SPC_PROC_KEY_SOBSL AS VENDOR_KEY,
    MATERIALID
    ||'_'
    ||SUBSTR(VENDOR_NAME,0,4)           AS VENDOR_ITEM,
    (SAFETY_STK)                        AS MIN_INV,
    CEIL(SAFETY_STK + 0.5*LOT_SIZE_QTY) AS TARGET_INV,
    CEIL(SAFETY_STK + 0.5*LOT_SIZE_QTY) AS MAX_INV,
    LOT_SIZE_QTY,
    LOT_ROUNDING_VALUE,
    LOT_SIZE_DISLS,
    AVG26_USAGE_QTY,
    STDEV26_USAGE,
    AVG13_USAGE_QTY,
    STDEV13_USAGE,
    Q1_LINES,
    Q2_LINES,
    Q3_LINES,
    Q4_LINES,
    Q1_FREQ_COUNT,
    Q2_FREQ_COUNT,
    Q3_FREQ_COUNT,
    Q4_FREQ_COUNT,
    EXCHANGE_RATE,
    LEVEL_TYPE,
    MATERIAL_LEVEL_VALUE,
    MRP_CONTROLLER,
    MRP_CONTROLLER_DISPO AS MRP_CONTROLLER_KEY,
    PURCH_GROUP,
    PURCH_GROUP_EKGRP AS PURCH_GROUP_KEY,
    PROD_SCHED_FEVOR  AS PROD_SCHED_KEY,
    REORDER_PT        AS RECORDER_POINT,
    (GRT + PDT + 1)   AS LEAD_TIME,
    MEINS_ISSUE_UOM   AS UNIT,
    ISSUE_UOM_NUMERATOR,
    PO_UOM_NUMERATOR,
    MATL_TYPE_MTART AS MATL_TYPE,
    ULTIMATE_SOURCE
  FROM INV_SAP_PP_OPTIMIZATION
  )PP_BASIC
LEFT JOIN
  (SELECT ID,
    MATERIAL,
    CATALOG_DASH,
    CATALOG_NO_DASH,
    SALES_ORG,
    DIST_CHL,
    D_CHAIN_BLK,
    STOCK_STATUS,
    CURRENT_SERIES
  FROM VIEW_INV_SAP_ITEM_ALL
  )ITEM_X
ON ITEM_X.ID = PP_BASIC.ID;

-- VIEW_INV_SAP_OPEN_SO BASIC OPEN SALES ORDER
DROP VIEW VIEW_INV_SAP_OPEN_SO;
SELECT * FROM VIEW_INV_SAP_OPEN_SO;
CREATE VIEW VIEW_INV_SAP_OPEN_SO AS 
SELECT SALESDOC
  ||'_'
  || SALESDOCITEM           AS SO_ID,
  MATERIAL
  ||'_'
  || PLANT           AS ID,
  SALESDOC                  AS SALES_DOC,
  SALESDOCITEM              AS LINE_NUM,
  MATERIAL                  AS MATERIAL,
  PLANT                     AS PLANT,
  SALES_ORG                 AS SALES_ORG,
  LINECREATEDATE            AS LINE_CREATED_DATE,
  SUBSTR(PRODHIER,0,3)      AS BU,
  ORDERQTY                  AS ORDER_QTY,
  OPEN_QTY                  AS OPEN_QTY,
  OPEN_QTY_BASE_UOM         AS OPEN_QTY_BASE_UOM,
  PROFITCENTER              AS PROFIT_CENTER,
  SALESPRICE                AS SALES_PRICE,
  CURRENCY                  AS CURRENCY,
  MAX_COMMIT_DATE           AS COMMITTED_DATE,
  MAX_CONFIRM_DATE          AS CONFIRM_DATE,
  SOLD_TO                   AS SOLD_TO_PARTY,
  DELIVSTATUS               AS DELIVERY_STATUS,
  OVERALLDELIVSTATSU        AS OVER_ALL_DELIVERY_STATUS,
  SALESDOCTYPE              AS SALE_DOC_TYPE,
  SALEDOCITEMCATEGORY_PSTYV AS SALEDOCITEMCATEGORY_PSTYV,
  SHIPFROM_VSTEL            AS SHIPPING_POINT,
  STOCKSTATUS               AS STOCK_STATUS,
  DELIVPRIO                 AS DELIVERY_PRIORITY,
  LST_ACT_GI_DATE           AS LST_ACT_GI_DATE,
  LST_DELV_CREATED_DATE     AS LST_DELIVERY_CREATE_DATE,
  REQTYPE                   AS REQUEST_TYPE,
  EXCHANGE_RATE_TO_USD      AS EXCHANGE_RATE_TO_USD
FROM INV_SAP_SALES_VBAK_VBAP_VBUP; 

--VIEW_INV_SAP_BACKLOG_SO
--WILL ADD PP INFORMATION IN IT
DROP VIEW VIEW_INV_SAP_BACKLOG_SO;
SELECT * FROM VIEW_INV_SAP_BACKLOG_SO;
CREATE VIEW VIEW_INV_SAP_BACKLOG_SO AS 
SELECT  OPEN_SO_BASIC.ID,
  OPEN_SO_BASIC.SO_ID,
  OPEN_SO_BASIC.SALES_DOC,
  OPEN_SO_BASIC.LINE_NUM,
  OPEN_SO_BASIC.MATERIAL,
  SALES_PP_X.CATALOG_DASH,
  SALES_PP_X.MAT_DESC,
  OPEN_SO_BASIC.PLANT,
  OPEN_SO_BASIC.SALES_ORG,
  OPEN_SO_BASIC.LINE_CREATED_DATE,
  OPEN_SO_BASIC.BU,
  OPEN_SO_BASIC.ORDER_QTY,
  OPEN_SO_BASIC.OPEN_QTY,
  OPEN_SO_BASIC.OPEN_QTY_BASE_UOM,
  SALES_PP_X.SAFETY_STOCK,
  SALES_PP_X.OH_QTY,
  SALES_PP_X.UNIT,
  SALES_PP_X.STRATEGY_GRP,
  OPEN_SO_BASIC.PROFIT_CENTER,
  OPEN_SO_BASIC.SALES_PRICE,
  OPEN_SO_BASIC.CURRENCY,
  OPEN_SO_BASIC.COMMITTED_DATE,
  OPEN_SO_BASIC.CONFIRM_DATE,
  OPEN_SO_BASIC.SOLD_TO_PARTY,
  OPEN_SO_BASIC.DELIVERY_STATUS,
  OPEN_SO_BASIC.OVER_ALL_DELIVERY_STATUS,
  OPEN_SO_BASIC.SALE_DOC_TYPE,
  OPEN_SO_BASIC.SALEDOCITEMCATEGORY_PSTYV,
  OPEN_SO_BASIC.SHIPPING_POINT,
  OPEN_SO_BASIC.STOCK_STATUS,
  OPEN_SO_BASIC.DELIVERY_PRIORITY,
  SALES_PP_X.MRP_TYPE,
  SALES_PP_X.VENDOR_KEY,
  SALES_PP_X.MRP_CONTROLLER,
  SALES_PP_X.PURCH_GROUP,
  SALES_PP_X.LEAD_TIME,
  SALES_PP_X.MATL_TYPE,
  OPEN_SO_BASIC.LST_ACT_GI_DATE,
  OPEN_SO_BASIC.LST_DELIVERY_CREATE_DATE,
  OPEN_SO_BASIC.REQUEST_TYPE,
  OPEN_SO_BASIC.EXCHANGE_RATE_TO_USD
FROM
  (SELECT ID,
    SO_ID,
    SALES_DOC,
    LINE_NUM,
    MATERIAL,
    PLANT,
    SALES_ORG,
    LINE_CREATED_DATE,
    BU,
    ORDER_QTY,
    OPEN_QTY,
    OPEN_QTY_BASE_UOM,
    PROFIT_CENTER,
    SALES_PRICE,
    CURRENCY,
    COMMITTED_DATE,
    CONFIRM_DATE,
    SOLD_TO_PARTY,
    DELIVERY_STATUS,
    OVER_ALL_DELIVERY_STATUS,
    SALE_DOC_TYPE,
    SALEDOCITEMCATEGORY_PSTYV,
    SHIPPING_POINT,
    STOCK_STATUS,
    DELIVERY_PRIORITY,
    LST_ACT_GI_DATE,
    LST_DELIVERY_CREATE_DATE,
    REQUEST_TYPE,
    EXCHANGE_RATE_TO_USD
  FROM VIEW_INV_SAP_OPEN_SO
  )OPEN_SO_BASIC
LEFT JOIN
  (SELECT ID,
    CATALOG_DASH,
    MAT_DESC,
    SAFETY_STOCK,
    OH_QTY,
    UNIT,
    STRATEGY_GRP,
    MRP_TYPE,
    VENDOR_KEY,
    MRP_CONTROLLER,
    PURCH_GROUP,
    LEAD_TIME,
    MATL_TYPE
  FROM VIEW_INV_SAP_PP_OPT_X
  )SALES_PP_X
ON SALES_PP_X.ID = OPEN_SO_BASIC.ID;

--VIEW_INV_SAP_SO_STATISTICS
--1.pass-due open qty and line
--2.LT open so qty and line
--3.(13weeks - LT) open so qty and line
--4. 13weeks after (Long Committed Date) open so qty and line
--5.All open so qty and line.
--LT 5040 14, 5050 8,5100 10,5110 11,5110 13,5160 16, 5190 16, 5200 10,5070 14, 5140 14

-- 5040 14,5110 13,5070 14, 5140 14

---NEED TO CREATE AND THINK.....

--BACKLOG_OPEN_QTY,PAST_DUE_OPEN_QTY,PO_SO_SA_FLAG,STO_OPEN_QTY
--OPEN STATUS

DROP VIEW VIEW_INV_SAP_SOPO_OPEN_QTY;
SELECT * FROM VIEW_INV_SAP_SOPO_OPEN_QTY;
CREATE VIEW VIEW_INV_SAP_SOPO_OPEN_QTY AS
SELECT SALES_OPEN_PASS_QTY.ID           AS ID,
  SALES_OPEN_PASS_QTY.BACKLOG_OPEN_QTY  AS BACKLOG_OPEN_QTY,
  SALES_OPEN_PASS_QTY.PAST_DUE_OPEN_QTY AS PAST_DUE_OPEN_QTY,
  STO_OPEN_QTY_S.PO_SO_SA_FLAG          AS PO_SO_SA_FLAG,
  STO_OPEN_QTY_S.STO_OPEN_QTY           AS STO_OPEN_QTY
FROM
  (
  --Sales Orders Status
  SELECT BACKLOG_OPEN.ID                   AS ID,
    NVL(BACKLOG_OPEN.OPEN_QTY,0)           AS BACKLOG_OPEN_QTY,
    NVL(PAST_DUE_OPEN.PAST_DUE_OPEN_QTY,0) AS PAST_DUE_OPEN_QTY
  FROM
    (SELECT MATERIAL
      ||'_'
      ||PLANT              AS ID,
      MATERIAL             AS MATERIALID,
      PLANT                AS PLANTID,
      NVL(SUM(OPEN_QTY),0) AS OPEN_QTY
    FROM INV_SAP_SALES_VBAK_VBAP_VBUP
    GROUP BY MATERIAL
      ||'_'
      ||PLANT,
      MATERIAL,
      PLANT
    )BACKLOG_OPEN
  LEFT JOIN
    (SELECT MATERIAL
      ||'_'
      ||PLANT               AS ID,
      MATERIAL              AS MATERIALID,
      PLANT                 AS PLANTID,
      NVL(SUM(OPEN_QTY), 0) AS PAST_DUE_OPEN_QTY
    FROM INV_SAP_SALES_VBAK_VBAP_VBUP
    WHERE MAX_COMMIT_DATE < SYSDATE - 1
    GROUP BY MATERIAL
      ||'_'
      ||PLANT,
      MATERIAL,
      PLANT
    )PAST_DUE_OPEN
  ON PAST_DUE_OPEN.ID = BACKLOG_OPEN.ID
  )SALES_OPEN_PASS_QTY
LEFT JOIN
  ---STO_OPEN_QTY
  (
  SELECT MATERIALID
    ||'_'
    ||PLANTID AS ID,
    MATERIALID,
    PLANTID,
    PO_SO_SA_FLAG,
    NVL(SUM(COMMITTEDQTY),0) AS STO_OPEN_QTY
  FROM INV_SAP_PP_PO_HISTORY
  WHERE PO_SO_SA_FLAG     = 'STO'
  AND DELIVERYCOMPLETE IS NULL
  GROUP BY MATERIALID,
    PLANTID,
    PO_SO_SA_FLAG
  )STO_OPEN_QTY_S
ON SALES_OPEN_PASS_QTY.ID = STO_OPEN_QTY_S.ID;
  
--VIEW_INV_SAP_INV_BASIC
DROP VIEW VIEW_INV_SAP_INV_BASIC;
SELECT * FROM VIEW_INV_SAP_INV_BASIC;
CREATE VIEW VIEW_INV_SAP_INV_BASIC AS
SELECT INV_BASIC.LAST_REVIEW_DATE AS LAST_REVIEW_DATE,
  INV_BASIC.ID                    AS ID,
  INV_BASIC.PLANT                 AS PLANT,
  INV_BASIC.MATERIAL              AS MATERIAL,
  ITEM_BASIC.CATALOG_DASH         AS CATALOG_DASH,
  ITEM_BASIC.MAT_DESC             AS MAT_DESC,
  INV_BASIC.TOTAL_QTY             AS TOTAL_QTY,
  INV_BASIC.LOCATION              AS LOCATION,
  ITEM_BASIC.PROD_BU              AS PROD_BU,
  ITEM_BASIC.MATL_TYPE            AS MATL_TYPE,
  ITEM_BASIC.MRP_TYPE             AS MRP_TYPE,
  ITEM_BASIC.STRATEGY_GRP         AS STRATEGY_GRP,
  ITEM_BASIC.SAFETY_STOCK         AS SAFETY_STOCK,
  ITEM_BASIC.RECORDER_POINT       AS RECORDER_POINT,
  ITEM_BASIC.UNIT_COST            AS UNIT_COST,
  ITEM_BASIC.LEAD_TIME            AS LEAD_TIME,
  ITEM_BASIC.VENDOR_ITEM          AS VENDOR_ITEM
FROM
  (SELECT MATERIALID
    ||'_'
    ||PLANTID     AS ID,
    MATERIALID    AS MATERIAL,
    PLANTID       AS PLANT,
    LOCATIONID    AS LOCATION,
    NVL(OH_QTY,0) AS TOTAL_QTY,
    ASOFDATE      AS LAST_REVIEW_DATE
  FROM INV_SAP_INVENTORY_BY_PLANT
  )INV_BASIC
LEFT JOIN
  (SELECT ID,
    CATALOG_DASH,
    MAT_DESC,
    SAFETY_STOCK,
    UNIT,
    STRATEGY_GRP,
    MRP_TYPE,
    PROD_BU,
    LEAD_TIME,
    RECORDER_POINT,
    UNIT_COST,
    VENDOR_ITEM,
    MATL_TYPE
  FROM VIEW_INV_SAP_PP_OPT_X
  )ITEM_BASIC
ON ITEM_BASIC.ID = INV_BASIC.ID;

--VIEW_INV_SAP_BACKLOG_INV
DROP VIEW VIEW_INV_SAP_BACKLOG_INV;
SELECT * FROM VIEW_INV_SAP_BACKLOG_INV;
CREATE VIEW VIEW_INV_SAP_BACKLOG_INV AS 
SELECT INV_BASIC.LAST_REVIEW_DATE,
  INV_BASIC.ID,
  INV_BASIC.PLANT,
  INV_BASIC.MATERIAL,
  INV_BASIC.CATALOG_DASH,
  INV_BASIC.MAT_DESC,
  INV_BASIC.TOTAL_QTY,
  INV_BASIC.LOCATION,
  SOPO_OPEN_QTY.BACKLOG_OPEN_QTY,
  SOPO_OPEN_QTY.PAST_DUE_OPEN_QTY,
  SOPO_OPEN_QTY.PO_SO_SA_FLAG,
  SOPO_OPEN_QTY.STO_OPEN_QTY,
  INV_BASIC.PROD_BU,
  INV_BASIC.MATL_TYPE,
  INV_BASIC.MRP_TYPE,
  INV_BASIC.STRATEGY_GRP,
  INV_BASIC.SAFETY_STOCK,
  INV_BASIC.RECORDER_POINT,
  INV_BASIC.UNIT_COST,
  INV_BASIC.LEAD_TIME,
  INV_BASIC.VENDOR_ITEM
FROM
  (SELECT LAST_REVIEW_DATE,
    ID,
    PLANT,
    MATERIAL,
    CATALOG_DASH,
    MAT_DESC,
    TOTAL_QTY,
    LOCATION,
    PROD_BU,
    MATL_TYPE,
    MRP_TYPE,
    STRATEGY_GRP,
    SAFETY_STOCK,
    RECORDER_POINT,
    UNIT_COST,
    LEAD_TIME,
    VENDOR_ITEM
  FROM VIEW_INV_SAP_INV_BASIC
  )INV_BASIC
LEFT JOIN
  (SELECT ID,
    BACKLOG_OPEN_QTY,
    PAST_DUE_OPEN_QTY,
    PO_SO_SA_FLAG,
    STO_OPEN_QTY
  FROM VIEW_INV_SAP_SOPO_OPEN_QTY
  )SOPO_OPEN_QTY
ON SOPO_OPEN_QTY.ID = INV_BASIC.ID;

--PO TAB INFOMATION
---INV_SAP_BACKLOG_PO










--DELIVERY RECORD


