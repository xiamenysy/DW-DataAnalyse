---To Create a useful tools for analyse pre-demand and supplier capacity.
---All plants
--'5041', '5051', '5101', '5111', '5121', '5161', '5191', '5201','5071','5141'
--'5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140'

--Weekly
--Catalog#
DECLARE
  CREATE_TABLE_INV_SAP_MATERIAL_CATALOG        VARCHAR2(1000);
  DROP_TABLE_INV_SAP_MATERIAL_CATALOG              VARCHAR2(1000);
BEGIN
  DROP_TABLE_INV_SAP_MATERIAL_CATALOG:= 'DROP TABLE INV_SAP_MATERIAL_CATALOG';
  CREATE_TABLE_INV_SAP_MATERIAL_CATALOG       := 'CREATE TABLE INV_SAP_MATERIAL_CATALOG AS SELECT * FROM DWQ$LIBRARIAN.INV_SAP_MATERIAL_CATALOG@ROCKWELL_DBLINK';
  EXECUTE IMMEDIATE DROP_TABLE;
  EXECUTE IMMEDIATE STR_CREATE_TABLE;
END;

--DWQ$LIBRARIAN.INV_SAP_SHIP_SOLD_TO_PARTYID@ROCKWELL_DBLINK
DECLARE
  CREATE_TABLE_INV_SAP_SHIP_SOLD_TO_PARTYID VARCHAR2(1000);
  DROP_TABLE_INV_SAP_SHIP_SOLD_TO_PARTYID   VARCHAR2(1000);
BEGIN
  DROP_TABLE_INV_SAP_MATERIAL_CATALOG   := 'DROP TABLE INV_SAP_SHIP_SOLD_TO_PARTYID';
  CREATE_TABLE_INV_SAP_MATERIAL_CATALOG := 'CREATE TABLE INV_SAP_SHIP_SOLD_TO_PARTYID AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SHIP_SOLD_TO_PARTYID@ROCKWELL_DBLINK';
  EXECUTE IMMEDIATE DROP_TABLE;
  EXECUTE IMMEDIATE STR_CREATE_TABLE;
END;

--DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
DROP TABLE INV_SAP_PP_MVKE;
CREATE TABLE INV_SAP_PP_MVKE AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK WHERE DIRECT_SHIP_PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

DECLARE
  CREATE_TABLE_INV_SAP_PP_MVKE VARCHAR2(1000);
  DROP_TABLE_INV_SAP_PP_MVKE   VARCHAR2(1000);
BEGIN
  DROP_TABLE_INV_SAP_PP_MVKE   := 'DROP TABLE INV_SAP_SHIP_SOLD_TO_PARTYID';
  CREATE_TABLE_INV_SAP_PP_MVKE := 'CREATE TABLE INV_SAP_PP_MVKE AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK WHERE DIRECT_SHIP_PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140')';
  EXECUTE IMMEDIATE DROP_TABLE;
  EXECUTE IMMEDIATE STR_CREATE_TABLE;
END;


--Basic Tables Update Every day
 
--DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK
Drop table INV_SAP_PP_OPTIMIZATION;
CREATE TABLE INV_SAP_PP_OPTIMIZATION AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID IN ('5041', '5051', '5101', '5111', '5121', '5161', '5191', '5201','5071','5141'); 

--DWQ$LIBRARIAN.INV_SAP_SALES_VBAK_VBAP_VBUP@ROCKWELL_DBLINK
Drop table INV_SAP_SALES_VBAK_VBAP_VBUP;
CREATE TABLE INV_SAP_SALES_VBAK_VBAP_VBUP AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_VBAK_VBAP_VBUP@ROCKWELL_DBLINK WHERE PLANT IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

--DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK
DROP TABLE INV_SAP_PP_FRCST_PBIM_PBED;
CREATE TABLE INV_SAP_PP_FRCST_PBIM_PBED AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

--DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
DROP TABLE INV_SAP_SALES_HST;
CREATE TABLE INV_SAP_SALES_HST AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

--DWQ$LIBRARIAN.INV_SAP_PP_PO_HISTORY@ROCKWELL_DBLINK
DROP TABLE INV_SAP_PP_PO_HISTORY;
CREATE TABLE INV_SAP_PP_PO_HISTORY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_PO_HISTORY@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

--DWQ$LIBRARIAN.INV_SAP_LIKP_LIPS_DAILY@ROCKWELL_DBLINK
DROP TABLE INV_SAP_LIKP_LIPS_DAILY;
CREATE TABLE INV_SAP_LIKP_LIPS_DAILY AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_LIKP_LIPS_DAILY@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

--DWQ$LIBRARIAN.INV_SAP_INVENTORY_BY_PLANT@ROCKWELL_DBLINK
DROP TABLE INV_SAP_INVENTORY_BY_PLANT;
CREATE TABLE INV_SAP_INVENTORY_BY_PLANT AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_INVENTORY_BY_PLANT@ROCKWELL_DBLINK WHERE PLANTID IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

