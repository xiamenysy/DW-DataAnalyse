--TEMP FILE


SELECT * FROM INV_SAP_PP_PO_HISTORY WHERE PLANTID = '5040' AND BSART_PURCHDOCTYPE = 'ZST' AND 

SELECT *
FROM VIEW_INV_SAP_BACKLOG_PO_TMP
WHERE PLANT       = '5040'
AND PURCHDOC_TYPE = 'ZST';

CREATE TABLE VIEW_INV_SAP_BACKLOG_PO_TMP AS 
SELECT * FROM VIEW_INV_SAP_BACKLOG_PO


SELECT * FROM INV_SAP_LIKP_LIPS_DAILY WHERE INCOTERMS2 = 'Shanghai' AND ACT_GI_DATE > SYSDATE - 39 

SELECT 
  DELIVERY.MATERIALID,
  DELIVERY.DELIVERY_QTY_SUOM,
  DELIVERY.CREATED_ON_DATE,
  DELIVERY.REFERENCE_DOC_TRIM,
  DELIVERY.REFERENCE_DOC_ITEM_TRIM,
  DELIVERY.CHANGED_ON_DATE,
  DELIVERY.ACT_GI_DATE,
  PRICE.UNIT_COST, 
  (DELIVERY.DELIVERY_QTY_SUOM*PRICE.UNIT_COST) AS ord_VALUE
FROM
(SELECT MATERIALID,
  DELIVERY_QTY_SUOM,
  CREATED_ON_DATE,
  REFERENCE_DOC_TRIM,
  REFERENCE_DOC_ITEM_TRIM,
  CHANGED_ON_DATE,
  ACT_GI_DATE
FROM INV_SAP_LIKP_LIPS_DAILY
WHERE INCOTERMS2 = 'Shanghai'
AND ACT_GI_DATE  > SYSDATE - 40
)DELIVERY
LEFT JOIN
(
SELECT MATERIALID,
UNIT_COST
FROM INV_SAP_PP_OPTIMIZATION WHERE PLANTID = '5040'
)PRICE
ON DELIVERY.MATERIALID = PRICE.MATERIALID;



SELECT PO,
  MATERIAL,
  STRATEGY_GRP,
  PO_OPEN_QTY,
  UNIT_COST,
  CURRENCY,
  CREATED_DATE,
  START_DELIVER_DATE,
  MAX_COMMITTED_DATE
FROM VIEW_INV_SAP_BACKLOG_PO_TMP
WHERE PLANT       = '5040'
AND PURCHDOC_TYPE = 'ZST';



SELECT MATERIAL,
  STRATEGY_GRP,
  SUM(PO_OPEN_QTY) AS SUM_OPEN,
  UNIT_COST,
  CURRENCY
FROM VIEW_INV_SAP_BACKLOG_PO_TMP
WHERE PLANT       = '5040'
AND PURCHDOC_TYPE = 'ZST'
GROUP BY
MATERIAL,
STRATEGY_GRP,
UNIT_COST,
CURRENCY
;

SELECT PLANTID,
  SALES_ORG,
  SALESDOC,
  SALESDOCITEM,
  MATERIALID,
  CATALOGID,
  LASTACTGIDATE,
  REQUIREDDELIVERYDATE,
  SALESDOCTYPE,
  ORDERQTY,
  SHIPQTY,
  OPENQTY
FROM INV_SAP_SALES_HST
WHERE LASTACTGIDATE between  to_char(SYSDATE - 101) and to_char(sysdate - 11)
AND PLANTID                  IN ('5040', '5050', '5100', '5110', '5120', '5160', '5190', '5200','5070','5140');

SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PO_PLAF@ROCKWELL_DBLINK WHERE BERID_MRPAREA = '5040'  

SELECT MATERIAL,CATALOG_DASH,CATALOG_NO_DASH,PROD_BU FROM VIEW_INV_SAP_PP_OPT_X;












SELECT SO_PP_BS.ID                  AS ID,
  SO_PP_BS.PROC_TYPE                AS PROC_TYPE,
  SO_PP_BS.PLANT                    AS PLANT,
  SO_PP_BS.SALES_ORG                AS SALES_ORG,
  SO_PP_BS.SHIPPING_POINT           AS SHIPPING_POINT,
  SO_PP_BS.SALE_DOC_TYPE            AS SALE_DOC_TYPE,
  SO_PP_BS.SALES_DOC                AS SALES_DOC,
  SO_PP_BS.LINE_NUM                 AS LINE_NUM,
  SO_PP_BS.MATERIAL                 AS MATERIAL,
  SO_PP_BS.CATALOG_DASH             AS CATALOG_DASH,
  SO_PP_BS.MAT_DESC                 AS MAT_DESC,
  SO_PP_BS.MATL_TYPE                AS MATL_TYPE,
  SO_PP_BS.SAFETY_STOCK             AS SAFETY_STOCK,
  SO_PP_BS.STRATEGY_GRP             AS STRATEGY_GRP,
  SO_PP_BS.LEAD_TIME                AS LEAD_TIME,
  SO_PP_BS.BU                       AS BU,
  SO_PP_BS.LINE_CREATED_DATE        AS LINE_CREATED_DATE,
  SO_PP_BS.REQUIRE_DATE             AS REQUIRE_DATE,
  SO_PP_BS.COMMITTED_DATE           AS COMMITTED_DATE,
  SO_PP_BS.CONFIRM_DATE             AS CONFIRM_DATE,
  0                                 AS GAP,
  SO_PP_BS.LST_ACT_GI_DATE          AS LST_ACT_GI_DATE,
  SO_PP_BS.LST_DELIVERY_CREATE_DATE AS LST_DELIVERY_CREATE_DATE,
  SO_PP_BS.ORDER_QTY                AS ORDER_QTY,
  SO_PP_BS.OPEN_QTY                 AS OPEN_QTY,
  SO_PP_BS.SHIPPED_QTY              AS SHIPPED_QTY,
  SO_PP_BS.UNIT                     AS UNIT,
  SO_PP_BS.PROFIT_CENTER            AS PROFIT_CENTER,
  SO_PP_BS.SALES_PRICE              AS SALES_PRICE,
  SO_PP_BS.CURRENCY                 AS CURRENCY,
  SO_PP_BS.SOLD_TO_PARTY            AS SOLD_TO_PARTY,
  SOLD_SHIP.SHIP_SOLD_TO_PARTY_NAME AS SHIP_SOLD_TO_PARTY_NAME,
  SO_PP_BS.ROUTE                    AS ROUTE,
  SO_PP_BS.DELIVERY_PRIORITY        AS DELIVERY_PRIORITY,
  SO_PP_BS.MRP_CONTROLLER           AS MRP_CONTROLLER,
  SO_PP_BS.PURCH_GROUP              AS PURCH_GROUP,
  SO_PP_BS.MRP_TYPE                 AS MRP_TYPE,
  SO_PP_BS.DELIVERY_STATUS          AS DELIVERY_STATUS,
  SO_PP_BS.OVER_ALL_DELIVERY_STATUS AS OVER_ALL_DELIVERY_STATUS,
  SO_PP_BS.VENDOR_KEY               AS VENDOR_KEY,
  SO_PP_BS.STOCK_STATUS             AS STOCK_STATUS,
  SO_PP_BS.REQTYPE                  AS REQTYPE,
  SO_PP_BS.EXCHANGE_RATE_TO_USD     AS EXCHANGE_RATE_TO_USD
FROM
  (SELECT OPEN_SO_BASIC.ID                             AS ID,
    SALES_PP_X.PROC_TYPE                               AS PROC_TYPE,
    OPEN_SO_BASIC.PLANT                                AS PLANT,
    OPEN_SO_BASIC.SALES_ORG                            AS SALES_ORG,
    OPEN_SO_BASIC.SHIPPING_POINT                       AS SHIPPING_POINT,
    OPEN_SO_BASIC.SALE_DOC_TYPE                        AS SALE_DOC_TYPE,
    OPEN_SO_BASIC.SALES_DOC                            AS SALES_DOC,
    OPEN_SO_BASIC.LINE_NUM                             AS LINE_NUM,
    OPEN_SO_BASIC.MATERIAL                             AS MATERIAL,
    SALES_PP_X.CATALOG_DASH                            AS CATALOG_DASH,
    SALES_PP_X.MAT_DESC                                AS MAT_DESC,
    SALES_PP_X.MATL_TYPE                               AS MATL_TYPE,
    SALES_PP_X.SAFETY_STOCK                            AS SAFETY_STOCK,
    SALES_PP_X.STRATEGY_GRP                            AS STRATEGY_GRP,
    SALES_PP_X.LEAD_TIME                               AS LEAD_TIME,
    OPEN_SO_BASIC.BU                                   AS BU,
    OPEN_SO_BASIC.LINE_CREATED_DATE                    AS LINE_CREATED_DATE,
    OPEN_SO_BASIC.REQUIRE_DATE                         AS REQUIRE_DATE,
    OPEN_SO_BASIC.COMMITTED_DATE                       AS COMMITTED_DATE,
    OPEN_SO_BASIC.CONFIRM_DATE                         AS CONFIRM_DATE,
    OPEN_SO_BASIC.LST_ACT_GI_DATE                      AS LST_ACT_GI_DATE,
    OPEN_SO_BASIC.LST_DELIVERY_CREATE_DATE             AS LST_DELIVERY_CREATE_DATE,
    OPEN_SO_BASIC.ORDER_QTY                            AS ORDER_QTY,
    OPEN_SO_BASIC.OPEN_QTY                             AS OPEN_QTY,
    (OPEN_SO_BASIC.ORDER_QTY - OPEN_SO_BASIC.OPEN_QTY) AS SHIPPED_QTY,
    SALES_PP_X.UNIT                                    AS UNIT,
    OPEN_SO_BASIC.PROFIT_CENTER                        AS PROFIT_CENTER,
    OPEN_SO_BASIC.SALES_PRICE                          AS SALES_PRICE,
    OPEN_SO_BASIC.CURRENCY                             AS CURRENCY,
    LPAD(OPEN_SO_BASIC.SOLD_TO_PARTY,10,'0')           AS SOLD_TO_PARTY,
    OPEN_SO_BASIC.ROUTE                                AS ROUTE,
    OPEN_SO_BASIC.DELIVERY_PRIORITY                    AS DELIVERY_PRIORITY,
    SALES_PP_X.MRP_CONTROLLER                          AS MRP_CONTROLLER,
    SALES_PP_X.PURCH_GROUP                             AS PURCH_GROUP,
    SALES_PP_X.MRP_TYPE                                AS MRP_TYPE,
    OPEN_SO_BASIC.DELIVERY_STATUS                      AS DELIVERY_STATUS,
    OPEN_SO_BASIC.OVER_ALL_DELIVERY_STATUS             AS OVER_ALL_DELIVERY_STATUS,
    SALES_PP_X.VENDOR_KEY                              AS VENDOR_KEY,
    OPEN_SO_BASIC.STOCK_STATUS                         AS STOCK_STATUS,
    OPEN_SO_BASIC.REQTYPE                              AS REQTYPE,
    OPEN_SO_BASIC.EXCHANGE_RATE_TO_USD                 AS EXCHANGE_RATE_TO_USD
  FROM
    (SELECT MATERIALID AS MATERIAL,


SALESDOC AS SALES_DOC,
SALESDOCITEM AS DOC_ITEM,
SOLDTOPARTY,
SHIPTOPARTY,
ITEMCATEGORY,
DELIVERYSTAUTS,
COMMITTEDDATE,
CALENDARWEEK,
FISCALYEARPERIOD,
CALENDARMONTH,
CONFIRMEDDELIVERYDATE,
LASTACTGIDATE,
LINECREATIONDATE,
REQUIREDDELIVERYDATE,
OVERALLDELIVERYSTATUS,
PLANTID,
REASONFORREJECTION,
SALESDOCTYPE,
PASSPORTORDER,
ORDERQTY,
CONFIRMEDQTY,
SHIPQTY,
OPENQTY,
UOM,
GBBB_SALES_AMT,
GBBB_SHIP_DATE,
ONTIMETO_DELIVERY,
ONTIMETO_CONFIRMED,
DW_DATE,
SALES_ORG,
CURRENCY,
GBBB_SALES_AMT_USD,
PRIORITY_ORDER,
PROFITCENTER,
REJECTSTATUS,
SHIPPING_POINT,
NUMERATOR,
DENOMINATOR,
BASE_ORDER_QTY,
BASE_SHIP_QTY,
BASE_OPEN_QTY,
BASE_CONFIRM_QTY,
SPAN_COMMIT_DAYS_LATE,
ADDRESS,
CITY,
STATE,
COUNTRY,
VBELN,
POSNR

    FROM INV_SAP_SALES_HST
    )OPEN_SO_BASIC
  LEFT JOIN
    (SELECT ID,
      CATALOG_DASH,
      MAT_DESC,
      SAFETY_STOCK,
      PROC_TYPE,
      UNIT,
      STRATEGY_GRP,
      MRP_TYPE,
      VENDOR_KEY,
      MRP_CONTROLLER,
      PURCH_GROUP,
      LEAD_TIME,
      MATL_TYPE
    FROM INV_SAP_PP_OPT_X
    )SALES_PP_X
  ON SALES_PP_X.ID = OPEN_SO_BASIC.ID
  )SO_PP_BS
LEFT JOIN
  (SELECT LPAD(SHIP_SOLD_TO_PARTY,10,'0') AS SHIP_SOLD_TO_PARTY,
    SHIP_SOLD_TO_PARTY_NAME
  FROM INV_SAP_SHIP_SOLD_TO
  )SOLD_SHIP
ON SO_PP_BS.SOLD_TO_PARTY = SOLD_SHIP.SHIP_SOLD_TO_PARTY;

SELECT MATERIAL, PROD_BU FROM INV_SAP_PP_OPT_X WHERE PLANT = '5040' AND PROD_BU = 'CDS'




SELECT * FROM
(SELECT DELIVERY,
DELIVERY_ITEM,
CREATED_BY,
CREATED_TIME,
CREATED_ON_DATE,
MATERIALID,
PLANTID,
CATALOGID,
MVMT_TYPE,
DELIVERY_QTY_SUOM,
BASE_UOM,
MATERIAL_AVAIL_DATE,
REFERENCE_DOC_TRIM,
REFERENCE_DOC_ITEM_TRIM,
DELIVERY_TYPE,
INCOTERMS1,
INCOTERMS2,
DELIVERY_PRIORITY,
CHANGED_ON_DATE,
ACT_GI_DATE,
DWQ_SRC_EXTRACT_DATE,
DELIVERY_QTY_STO_ITEM,
PLANNED_GI_DATE
FROM INV_SAP_LIKP_LIPS_DAILY WHERE INCOTERMS2 = 'SHANGHAI' AND PLANTID = '1090')DELI
LEFT JOIN
(SELECT MATERIAL, PROD_BU,UNIT_COST FROM INV_SAP_PP_OPT_X WHERE PLANT = '5040' AND PROD_BU = 'CDS')CDS
ON CDS.MATERIAL = DELI.MATERIALID


      SELECT *
          FROM
            (SELECT EBELNPURCHDOCNO
              ||'_'
              ||MATERIALID AS PO_ID,
              MATERIALID
              ||'_'
              ||PLANTID                  AS ID,
              MATERIALID                 AS MATERIAL,
              PLANTID                    AS PLANT,
              BSTYP_PURCHDOCCAT          AS PURCHDOCCAT,
              BSART_PURCHDOCTYPE         AS PURCHDOC_TYPE,
              LIFNR_VENDORNO             AS VENDOR,
              EBELNPURCHDOCNO            AS PO,
              EBELPPURCHITEMNO           AS ITEM,
              MENGESCHEDULEDQTY          AS PURHCASE_QTY,
              WEMNGRECEIVEDQTY           AS RECEIVED_QTY,
              DELIVERYCOMPLETE           AS DELIVERY_COMPLETE_FLAG,
              COMMITTED_DATE             AS COMMITTED_DATE,
              COMMITTEDQTY               AS COMMITTED_QTY,
              PO_SO_SA_FLAG              AS PO_SO_SA_FLAG,
              BEDATSCHEDULELINEORDERDATE AS CREATED_DATE,
              WAERS_CURRENCYKEY          AS CURRENCY,
              NETWRNETORDERVALUE         AS ORDER_VALUE,
              LT                         AS LEAD_TIME,
              GRT                        AS GRT,
              MRP_CONTROLLER             AS MRP_CONTROLLER,
              SUBSTR(SPC_PROC_KEY,-2)    AS PROC_KEY,
              PURCH_GROUP                AS PURCH_GROUP,
              STRATEGY_GRP               AS STRATEGY_GRP,
              UNIT_COST                  AS UNIT_COST,
              PURCH_REQ                  AS PR,
              SHIPPING_POINT             AS SHIPPING_POINT,
              DELIVERY_PRIORITY          AS DELIVERY_PRIORITY,
              ROUTE                      AS ROUTE,
              TRANSIT_DAYS               AS TRANSIT_DAYS,
              (UNIT_COST*WEMNGRECEIVEDQTY)   AS VALUE_KEY
            FROM INV_SAP_PP_PO_HISTORY
            WHERE DELIVERYCOMPLETE      IS NOT NULL AND LIFNR_VENDORNO = 'V1090' AND PLANTID = '5040'
            )PO_HIS
          LEFT JOIN
        (SELECT ID,
          CATALOG_DASH,
          MAT_DESC,
          MRP_TYPE,
          PROD_BU,
          MATL_TYPE
        FROM INV_SAP_PP_OPT_X
        )ITEM_BASIC
      ON ITEM_BASIC.ID = PO_HIS.ID;

SELECT * FROM INV_SAP_SALES_HST WHERE PLANTID = '5040' AND COMMITTEDDATE BETWEEN TO_CHAR(SYSDATE - 4) AND TO_CHAR(SYSDATE + 1);

SELECT * FROM INV_SAP_SALES_VBAK_VBAP_VBUP WHERE SALESDOC = '6501943473' AND MATERIAL = 'PN-12175'












