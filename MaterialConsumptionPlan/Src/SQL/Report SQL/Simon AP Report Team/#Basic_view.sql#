--Porject Name: Basic Function View
--Author: Huang Moyue 
--Mail: mhuang1@ra.rockwell.com
--Date:09/26/2014
--Summary: Automation Files Center Job Logs and set up process
--VIEW_INV_SAP_ITEM_SOG_X 

SELECT * FROM INV_SAP_ITEM_SOG_X;

DROP VIEW VIEW_INV_SAP_ITEM_SOG_X;
DROP TABLE INV_SAP_ITEM_SOG_X;
CREATE TABLE INV_SAP_ITEM_SOG_X AS SELECT * FROM VIEW_INV_SAP_ITEM_SOG_X;
CREATE VIEW VIEW_INV_SAP_ITEM_SOG_X AS
SELECT DISTINCT ISPM.ID  AS ID,
  ISPM.SOG_ID            AS SOG_ID,
  ISPM.SALES_ORG         AS SALES_ORG,
  ISPM.DIRECT_SHIP_PLANT AS PLANT,
  ISPM.MATERIALID        AS MATERIAL,
  ISMC.CATALOG_STRING1   AS CATALOG_DASH,
  ISMC.CATALOG_STRING2   AS CATALOG_NO_DASH,
  ISPM.DIST_CHL          AS DIST_CHL,
  ISPM.CURRENT_SERIES    AS CURRENT_SERIES,
  ISPM.D_CHAIN_BLK       AS D_CHAIN_BLK,
  
   ISPM. DELIVERY_UNIT,
    MIN_DELIVERY_QTY,
    MIN_ORDER_QTY,
    ALLOWED_SCHED_RTRN,
    ALLOWED_PREAUTH_RTRN,
    DMI_MANAGED,
    VALID_FROM_DATE,
    STOCK_STATUS,
    PREFERRED_PRODUCT,
    PUBLISHED_LT
FROM
  (SELECT DISTINCT MATERIALID
    ||'_'
    ||SALES_ORG AS SOG_ID,
    MATERIALID
    ||'_'
    ||DIRECT_SHIP_PLANT AS ID,
    MATERIALID,
    SALES_ORG,
    D_CHAIN_BLK,
    DIST_CHL,
    DIRECT_SHIP_PLANT,
    CURRENT_SERIES,
    
    DELIVERY_UNIT,
    MIN_DELIVERY_QTY,
    MIN_ORDER_QTY,
    ALLOWED_SCHED_RTRN,
    ALLOWED_PREAUTH_RTRN,
    DMI_MANAGED,
    VALID_FROM_DATE,
    STOCK_STATUS,
    PREFERRED_PRODUCT,
    PUBLISHED_LT
  FROM INV_SAP_PP_MVKE
  WHERE CURRENT_SERIES = 'X'
  )ISPM
LEFT JOIN
  (SELECT CATALOG_STRING1,
    CATALOG_STRING2,
    MATERIALID
  FROM INV_SAP_NODASH_MAT_CATA
  )ISMC
ON ISPM.MATERIALID = ISMC.MATERIALID;