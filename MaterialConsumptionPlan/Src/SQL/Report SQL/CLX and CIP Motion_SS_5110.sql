
--------------------------------------26 weeks Usage Lines Count----------------------------
SELECT MATERIALID, PLANTID, (SUM(PLANTID)/PLANTID) AS LINE_COUNT
FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
WHERE MATERIALID    IN ('1734-EP24DC B')
AND PLANTID          = '5110'
AND COMMITTEDDATE BETWEEN TO_CHAR(sysdate - 182) AND TO_CHAR(sysdate)
GROUP BY MATERIALID, PLANTID;
  



-----------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------
---Time: 5.28 12:00AM

--0.5
SELECT  MATERIALID
      ||'_'
      ||DIRECT_SHIP_PLANT            AS ID,
  MATERIALID,
  CURRENT_SERIES,
  DIRECT_SHIP_PLANT
FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
WHERE CURRENT_SERIES   = 'X' AND MATERIALID IN (

);


--1. Check X current serials

SELECT  MATERIALID
      ||'_'
      ||DIRECT_SHIP_PLANT            AS ID,
  MATERIALID,
  CURRENT_SERIES,
  DIRECT_SHIP_PLANT
FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND MATERIALID IN ('1734-AENT A',
'1734-ARM C',
'1734-EP24DC B',
'1734-IB8 C',
'1734-IE2C C',
'1734-IE2V C',
'1734-OB8E C',
'1734-OE2V C',
'1734-OE4C C',
'1734-SSI C',
'1734-TB A',
'1734-VHSC24 C',
'1756-A10 B',
'1756-EN2T A',
'1756-PA75 B',
'1756-PB72 C',
'350325-A06',
'387985-A01',
'74106-841-55',
'74106-841-58',
'74106-845-51',
'74106-851-51',
'74106-870-51',
'PN-114257',
'PN-109108',
'PN-12151',
'PN-12196',
'PN-12309',
'PN-12324',
'PN-164066',
'PN-130651',
'PN-171228',
'PN-137681',
'PN-240520',
'PN-193342',
'PN-193343',
'PN-184723',
'PN-184727',
'PN-197728',
'PN-42400',
'PN-42424',
'PN-42426',
'PN-42427',
'PN-52785',
'PN-52908',
'PN-55608',
'PN-55610',
'PN-55612',
'PN-46250',
'PN-46252',
'PN-46293',
'PN-24871',
'PN-25132',
'PN-49876',
'PN-50060',
'PN-31815',
'PN-52231',
'PN-80688',
'PN-80689',
'PN-80690',
'PN-80691',
'PN-80692',
'PN-81191',
'PN-81192',
'PN-81193',
'PN-81194',
'PN-81198',
'PN-82262',
'PN-90600',
'PN-90602',
'PN-83542',
'PN-83545',
'PN-75005',
'PN-75008',
'PN-85064',
'PN-85066',
'PN-85068',
'PN-98690',
'PN-65689'
);

--2. 5110 data. oh, ss, fc_avg, 26weeks line count 

--Basic Data
CREATE TABLE CIP_5110_BASIC_DATA AS
SELECT 
PLANTID ||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
MAT_DESC,
SAFETY_STK,
LOT_SIZE,
OH_QTY,
UNIT_COST,
OH_$$,
MAX_INV_$$,
OH_WOS,
PLAN_INV_WOS,
PROD_BU,
PROD_FAM,
PROD_HIERARCHY,
STRATEGY_GRP,
MRP_TYPE,
VENDOR_NAME,
LOT_ROUNDING_VALUE,
AVG26_USAGE_QTY,
GRT,
PDT,
MEINS_ISSUE_UOM,
MATL_TYPE_MTART  FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND      
MATERIALID IN ('1734-ARM C',
'1734-EP24DC B',
'1734-IE2C C',
'1734-IE2V C',
'1734-OB8 C',
'1734-OB8E C',
'1734-OE2V C',
'1734-OE4C C',
'1734-SSI C',
'1734-TB A',
'1734-VHSC24 C',
'1756-PA75 B',
'1756-PB72 C',
'350325-A06',
'387985-A01',
'74106-845-51',
'74106-870-51',
'PN-109108',
'PN-114257',
'PN-12309',
'PN-130651',
'PN-171228',
'PN-184723',
'PN-184727',
'PN-25132',
'PN-46250',
'PN-46252',
'PN-46293',
'PN-49876',
'PN-52231',
'PN-55608',
'PN-80688',
'PN-80689',
'PN-80690',
'PN-80691',
'PN-81191',
'PN-81192',
'PN-81193',
'PN-81194',
'PN-82262',
'PN-83542',
'PN-83545',
'PN-85064',
'PN-85066',
'PN-85068',
'PN-90600',
'PN-90602',
'PN-98690',
'1756-A10 B',
'74106-851-51',
'PN-12151',
'PN-12196',
'PN-12324',
'PN-42424',
'PN-42426',
'PN-42427',
'PN-52785',
'PN-55610',
'PN-55612',
'PN-75005',
'PN-75008',
'PN-80692',
'PN-137681',
'PN-81198',
'PN-31815',
'PN-42400');


--26weeks line count
CREATE TABLE CIP_5110_26WEEKS AS
SELECT 
PLANTID ||'_'||MATERIALID AS ID,
MATERIALID, PLANTID, (SUM(PLANTID)/PLANTID) AS LINE_COUNT
FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
WHERE MATERIALID    IN  ('1734-ARM C',
'1734-EP24DC B',
'1734-IE2C C',
'1734-IE2V C',
'1734-OB8 C',
'1734-OB8E C',
'1734-OE2V C',
'1734-OE4C C',
'1734-SSI C',
'1734-TB A',
'1734-VHSC24 C',
'1756-PA75 B',
'1756-PB72 C',
'350325-A06',
'387985-A01',
'74106-845-51',
'74106-870-51',
'PN-109108',
'PN-114257',
'PN-12309',
'PN-130651',
'PN-171228',
'PN-184723',
'PN-184727',
'PN-25132',
'PN-46250',
'PN-46252',
'PN-46293',
'PN-49876',
'PN-52231',
'PN-55608',
'PN-80688',
'PN-80689',
'PN-80690',
'PN-80691',
'PN-81191',
'PN-81192',
'PN-81193',
'PN-81194',
'PN-82262',
'PN-83542',
'PN-83545',
'PN-85064',
'PN-85066',
'PN-85068',
'PN-90600',
'PN-90602',
'PN-98690',
'1756-A10 B',
'74106-851-51',
'PN-12151',
'PN-12196',
'PN-12324',
'PN-42424',
'PN-42426',
'PN-42427',
'PN-52785',
'PN-55610',
'PN-55612',
'PN-75005',
'PN-75008',
'PN-80692',
'PN-137681',
'PN-81198',
'PN-31815',
'PN-42400')
AND PLANTID          = '5110'
AND COMMITTEDDATE BETWEEN TO_CHAR(sysdate - 182) AND TO_CHAR(sysdate)
GROUP BY MATERIALID, PLANTID;


SELECT * FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK WHERE  PLANTID = '5110'
    AND VERSBP_VERSION = '55'
    AND MATERIALID = '1734-TB A';

--VSE_FC_AVG
CREATE TABLE CIP_5110_FCAVG AS
SELECT PLANTID
      ||'_'
      ||MATERIALID                           AS ID,
      MATERIALID                          AS MATERIALID,
      PLANTID                             AS PLANTID,
      CEIL(SUM(PLNMG_PLANNEDQUANTITY)/26) AS FC_AVG_WEEK
    FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK
    WHERE (PDATU_DELIV_ORDFINISHDATE BETWEEN TO_CHAR(sysdate) AND TO_CHAR(sysdate + 182))
    AND PLANTID = '5110'
    AND VERSBP_VERSION = '55'
    AND MATERIALID    IN  ('1734-ARM C',
'1734-EP24DC B',
'1734-IE2C C',
'1734-IE2V C',
'1734-OB8 C',
'1734-OB8E C',
'1734-OE2V C',
'1734-OE4C C',
'1734-SSI C',
'1734-TB A',
'1734-VHSC24 C',
'1756-PA75 B',
'1756-PB72 C',
'350325-A06',
'387985-A01',
'74106-845-51',
'74106-870-51',
'PN-109108',
'PN-114257',
'PN-12309',
'PN-130651',
'PN-171228',
'PN-184723',
'PN-184727',
'PN-25132',
'PN-46250',
'PN-46252',
'PN-46293',
'PN-49876',
'PN-52231',
'PN-55608',
'PN-80688',
'PN-80689',
'PN-80690',
'PN-80691',
'PN-81191',
'PN-81192',
'PN-81193',
'PN-81194',
'PN-82262',
'PN-83542',
'PN-83545',
'PN-85064',
'PN-85066',
'PN-85068',
'PN-90600',
'PN-90602',
'PN-98690',
'1756-A10 B',
'74106-851-51',
'PN-12151',
'PN-12196',
'PN-12324',
'PN-42424',
'PN-42426',
'PN-42427',
'PN-52785',
'PN-55610',
'PN-55612',
'PN-75005',
'PN-75008',
'PN-80692',
'PN-137681',
'PN-81198',
'PN-31815',
'PN-42400')
    GROUP BY MATERIALID,
      MATERIALID
      ||'_'
      ||PLANTID,
      PLANTID,
      MATERIALID;


-----SUPPLIER STATUS
CREATE TABLE CIP_5110_SUPPLIERS AS
SELECT * FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK)
WHERE ID IN ('4000_1734-ARM C',
'4000_1734-EP24DC B',
'4000_1734-IE2C C',
'4000_1734-IE2V C',
'4000_1734-OB8E C',
'4000_1734-OE2V C',
'4000_1734-OE4C C',
'4000_1734-SSI C',
'4000_1734-TB A',
'4000_1734-VHSC24 C',
'1180_1756-A10 B',
'4000_1756-PA75 B',
'4000_1756-PB72 C',
'4000_350325-A06',
'4000_387985-A01',
'4000_74106-845-51',
'1180_74106-851-51',
'4000_74106-870-51',
'4000_PN-109108',
'4000_PN-114257',
'1180_PN-12151',
'1180_PN-12196',
'1090_PN-12309',
'1180_PN-12324',
'4000_PN-130651',
'4000_PN-137681',
'2083_PN-164066',
'4000_PN-171228',
'4000_PN-184723',
'4000_PN-184727',
'4000_PN-25132',
'4000_PN-31815',
'1100_PN-42400',
'1180_PN-42424',
'1180_PN-42426',
'1180_PN-42427',
'4000_PN-46250',
'4000_PN-46252',
'1090_PN-46293',
'4000_PN-49876',
'4000_PN-52231',
'1180_PN-52785',
'4000_PN-55608',
'1180_PN-55610',
'1180_PN-55612',
'1180_PN-75005',
'1180_PN-75008',
'4000_PN-80688',
'4000_PN-80689',
'4000_PN-80690',
'4000_PN-80691',
'1180_PN-80692',
'4000_PN-81191',
'4000_PN-81192',
'4000_PN-81193',
'4000_PN-81194',
'4000_PN-81198',
'4000_PN-82262',
'4000_PN-83542',
'4000_PN-83545',
'4000_PN-85064',
'1090_PN-85066',
'4000_PN-85068',
'4000_PN-90600',
'4000_PN-90602',
'4000_PN-98690');

---ANALYSE REPORT BASE DATA
DROP TABLE CIP_5110_26WEEKS;
DROP TABLE CIP_5110_BASIC_DATA;
DROP TABLE CIP_5110_FCAVG;
DROP TABLE CIP_5110_SUPPLIERS;

SELECT * FROM CIP_5110_26WEEKS;
SELECT * FROM CIP_5110_BASIC_DATA;
SELECT * FROM CIP_5110_FCAVG;
SELECT * FROM CIP_5110_SUPPLIERS;

----------------------------------------------------------------------------------------------------------------
--LOCAL STATUS
SELECT 
PP_BI_SLAES_LC.ID AS ID,
PP_BI_SLAES_LC.MATERIALID AS MATERIALID,
PP_BI_SLAES_LC.PLANTID AS PLANTID,
PP_BI_SLAES_LC.MAT_DESC AS MAT_DESC,
PP_BI_SLAES_LC.SAFETY_STK AS SAFETY_STK,
PP_BI_SLAES_LC.LOT_SIZE AS LOT_SIZE,
PP_BI_SLAES_LC.OH_QTY AS OH_QTY,
PP_BI_SLAES_LC.UNIT_COST AS UNIT_COST,
PP_BI_SLAES_LC.OH_$$ AS OH_$$,
PP_BI_SLAES_LC.MAX_INV_$$ AS MAX_INV_$$,
PP_BI_SLAES_LC.OH_WOS AS OH_WOS,
PP_BI_SLAES_LC.PLAN_INV_WOS AS PLAN_INV_WOS,
PP_BI_SLAES_LC.PROD_BU AS PROD_BU,
PP_BI_SLAES_LC.STRATEGY_GRP AS STRATEGY_GRP,
SUBSTR(PP_BI_SLAES_LC.VENDOR_NAME,0,4)||'_'||PP_BI_SLAES_LC.MATERIALID AS VENDOR_ITEM,
PP_BI_SLAES_LC.LOT_ROUNDING_VALUE AS LOT_ROUNDING_VALUE,
PP_BI_SLAES_LC.AVG26_USAGE_QTY AS AVG26_USAGE_QTY,
PP_BI_SLAES_LC.USE_LINES_COUNT_26WEEKS  AS USE_LINES_COUNT_26WEEKS,
FC_AVG.FC_AVG_WEEK AS FC_AVG_WEEK,
PP_BI_SLAES_LC.GRT AS GRT,
PP_BI_SLAES_LC.PDT AS PDT,
PP_BI_SLAES_LC.MEINS_ISSUE_UOM AS MEINS_ISSUE_UOM,
PP_BI_SLAES_LC.MATL_TYPE_MTART AS MATL_TYPE_MTART
FROM
(
SELECT 
PP_BASIC_INFO.ID AS ID,
PP_BASIC_INFO.MATERIALID AS MATERIALID,
PP_BASIC_INFO.PLANTID AS PLANTID,
PP_BASIC_INFO.MAT_DESC AS MAT_DESC,
PP_BASIC_INFO.SAFETY_STK AS SAFETY_STK,
PP_BASIC_INFO.LOT_SIZE AS LOT_SIZE,
PP_BASIC_INFO.OH_QTY AS OH_QTY,
PP_BASIC_INFO.UNIT_COST AS UNIT_COST,
PP_BASIC_INFO.OH_$$ AS OH_$$,
PP_BASIC_INFO.MAX_INV_$$ AS MAX_INV_$$,
PP_BASIC_INFO.OH_WOS AS OH_WOS,
PP_BASIC_INFO.PLAN_INV_WOS AS PLAN_INV_WOS,
PP_BASIC_INFO.PROD_BU AS PROD_BU,
PP_BASIC_INFO.STRATEGY_GRP AS STRATEGY_GRP,
PP_BASIC_INFO.MRP_TYPE AS MRP_TYPE,
PP_BASIC_INFO.VENDOR_NAME AS VENDOR_NAME,
PP_BASIC_INFO.LOT_ROUNDING_VALUE AS LOT_ROUNDING_VALUE,
PP_BASIC_INFO.AVG26_USAGE_QTY AS AVG26_USAGE_QTY,
SALES_LINT_COUNT.LINE_COUNT  AS USE_LINES_COUNT_26WEEKS,
PP_BASIC_INFO.GRT AS GRT,
PP_BASIC_INFO.PDT AS PDT,
PP_BASIC_INFO.MEINS_ISSUE_UOM AS MEINS_ISSUE_UOM,
PP_BASIC_INFO.MATL_TYPE_MTART AS MATL_TYPE_MTART
FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
MAT_DESC,
SAFETY_STK,
LOT_SIZE,
OH_QTY,
UNIT_COST,
OH_$$,
MAX_INV_$$,
OH_WOS,
PLAN_INV_WOS,
PROD_BU,
STRATEGY_GRP,
MRP_TYPE,
VENDOR_NAME,
LOT_ROUNDING_VALUE,
AVG26_USAGE_QTY,
GRT,
PDT,
MEINS_ISSUE_UOM,
MATL_TYPE_MTART  FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND  MATERIALID IN ('1734-ARM C')
)PP_BASIC_INFO
LEFT JOIN
(
SELECT 
PLANTID||'_'||MATERIALID AS ID,
(SUM(PLANTID)/PLANTID) AS LINE_COUNT
FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
WHERE MATERIALID    IN  ('1734-ARM C')
AND PLANTID          = '5110'
AND COMMITTEDDATE BETWEEN TO_CHAR(sysdate - 182) AND TO_CHAR(sysdate)
GROUP BY MATERIALID, PLANTID,PLANTID||'_'||MATERIALID
)SALES_LINT_COUNT 
ON PP_BASIC_INFO.ID = SALES_LINT_COUNT.ID
)PP_BI_SLAES_LC
LEFT JOIN
(
SELECT PLANTID
      ||'_'
      ||MATERIALID                           AS ID,
      CEIL(SUM(PLNMG_PLANNEDQUANTITY)/26) AS FC_AVG_WEEK
    FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK
    WHERE (PDATU_DELIV_ORDFINISHDATE BETWEEN TO_CHAR(sysdate) AND TO_CHAR(sysdate + 182))
    AND PLANTID = '5110'
    AND VERSBP_VERSION = '55'
    AND MATERIALID IN  ('1734-ARM C')
    GROUP BY MATERIALID, PLANTID ||'_' ||MATERIALID, PLANTID
)FC_AVG
ON FC_AVG.ID = PP_BI_SLAES_LC.ID;


---Supplier Status
SELECT ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM
FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK)
WHERE ID IN (SELECT DISTINCT
SUBSTR(VENDOR_NAME,0,4)||'_'||MATERIALID AS VENDOR_ITEM
FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND  MATERIALID IN ('1734-ARM C',
'1734-EP24DC B',
'1734-IE2C C',
'1734-IE2V C',
'1734-OB8E C',
'1734-OE2V C',
'1734-OE4C C',
'1734-SSI C',
'1734-TB A',
'1734-VHSC24 C',
'1756-A10 B',
'1756-PA75 B',
'1756-PB72 C',
'350325-A06',
'387985-A01',
'74106-845-51',
'74106-851-51',
'74106-870-51',
'PN-114257',
'PN-109108',
'PN-12151',
'PN-12196',
'PN-12309',
'PN-12324',
'PN-164066',
'PN-130651',
'PN-171228',
'PN-137681',
'PN-184723',
'PN-184727',
'PN-42400',
'PN-42424',
'PN-42426',
'PN-42427',
'PN-52785',
'PN-55608',
'PN-55610',
'PN-55612',
'PN-46250',
'PN-46252',
'PN-46293',
'PN-25132',
'PN-49876',
'PN-31815',
'PN-52231',
'PN-80688',
'PN-80689',
'PN-80690',
'PN-80691',
'PN-80692',
'PN-81191',
'PN-81192',
'PN-81193',
'PN-81194',
'PN-81198',
'PN-82262',
'PN-90600',
'PN-90602',
'PN-83542',
'PN-83545',
'PN-75005',
'PN-75008',
'PN-85064',
'PN-85066',
'PN-85068',
'PN-98690'));


------local and suppiler join together
SELECT * FROM
(
SELECT 
PP_BI_SLAES_LC.ID AS ID,
PP_BI_SLAES_LC.MATERIALID AS MATERIALID,
PP_BI_SLAES_LC.PLANTID AS PLANTID,
PP_BI_SLAES_LC.MAT_DESC AS MAT_DESC,
PP_BI_SLAES_LC.SAFETY_STK AS SAFETY_STK,
PP_BI_SLAES_LC.LOT_SIZE AS LOT_SIZE,
PP_BI_SLAES_LC.OH_QTY AS OH_QTY,
PP_BI_SLAES_LC.UNIT_COST AS UNIT_COST,
PP_BI_SLAES_LC.OH_$$ AS OH_$$,
PP_BI_SLAES_LC.MAX_INV_$$ AS MAX_INV_$$,
PP_BI_SLAES_LC.OH_WOS AS OH_WOS,
PP_BI_SLAES_LC.PLAN_INV_WOS AS PLAN_INV_WOS,
PP_BI_SLAES_LC.PROD_BU AS PROD_BU,
PP_BI_SLAES_LC.STRATEGY_GRP AS STRATEGY_GRP,
SUBSTR(PP_BI_SLAES_LC.VENDOR_NAME,0,4)||'_'||PP_BI_SLAES_LC.MATERIALID AS VENDOR_ITEM,
PP_BI_SLAES_LC.LOT_ROUNDING_VALUE AS LOT_ROUNDING_VALUE,
PP_BI_SLAES_LC.AVG26_USAGE_QTY AS AVG26_USAGE_QTY,
PP_BI_SLAES_LC.USE_LINES_COUNT_26WEEKS  AS USE_LINES_COUNT_26WEEKS,
FC_AVG.FC_AVG_WEEK AS FC_AVG_WEEK,
PP_BI_SLAES_LC.GRT AS GRT,
PP_BI_SLAES_LC.PDT AS PDT,
PP_BI_SLAES_LC.MEINS_ISSUE_UOM AS MEINS_ISSUE_UOM,
PP_BI_SLAES_LC.MATL_TYPE_MTART AS MATL_TYPE_MTART
FROM
(
SELECT 
PP_BASIC_INFO.ID AS ID,
PP_BASIC_INFO.MATERIALID AS MATERIALID,
PP_BASIC_INFO.PLANTID AS PLANTID,
PP_BASIC_INFO.MAT_DESC AS MAT_DESC,
PP_BASIC_INFO.SAFETY_STK AS SAFETY_STK,
PP_BASIC_INFO.LOT_SIZE AS LOT_SIZE,
PP_BASIC_INFO.OH_QTY AS OH_QTY,
PP_BASIC_INFO.UNIT_COST AS UNIT_COST,
PP_BASIC_INFO.OH_$$ AS OH_$$,
PP_BASIC_INFO.MAX_INV_$$ AS MAX_INV_$$,
PP_BASIC_INFO.OH_WOS AS OH_WOS,
PP_BASIC_INFO.PLAN_INV_WOS AS PLAN_INV_WOS,
PP_BASIC_INFO.PROD_BU AS PROD_BU,
PP_BASIC_INFO.STRATEGY_GRP AS STRATEGY_GRP,
PP_BASIC_INFO.MRP_TYPE AS MRP_TYPE,
PP_BASIC_INFO.VENDOR_NAME AS VENDOR_NAME,
PP_BASIC_INFO.LOT_ROUNDING_VALUE AS LOT_ROUNDING_VALUE,
PP_BASIC_INFO.AVG26_USAGE_QTY AS AVG26_USAGE_QTY,
SALES_LINT_COUNT.LINE_COUNT  AS USE_LINES_COUNT_26WEEKS,
PP_BASIC_INFO.GRT AS GRT,
PP_BASIC_INFO.PDT AS PDT,
PP_BASIC_INFO.MEINS_ISSUE_UOM AS MEINS_ISSUE_UOM,
PP_BASIC_INFO.MATL_TYPE_MTART AS MATL_TYPE_MTART
FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
MAT_DESC,
SAFETY_STK,
LOT_SIZE,
OH_QTY,
UNIT_COST,
OH_$$,
MAX_INV_$$,
OH_WOS,
PLAN_INV_WOS,
PROD_BU,
STRATEGY_GRP,
MRP_TYPE,
VENDOR_NAME,
LOT_ROUNDING_VALUE,
AVG26_USAGE_QTY,
GRT,
PDT,
MEINS_ISSUE_UOM,
MATL_TYPE_MTART  FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND  MATERIALID IN ('1734-ARM C')
)PP_BASIC_INFO
LEFT JOIN
(
SELECT 
PLANTID||'_'||MATERIALID AS ID,
(SUM(PLANTID)/PLANTID) AS LINE_COUNT
FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
WHERE MATERIALID    IN  ('1734-ARM C')
AND PLANTID          = '5110'
AND COMMITTEDDATE BETWEEN TO_CHAR(sysdate - 182) AND TO_CHAR(sysdate)
GROUP BY MATERIALID, PLANTID,PLANTID||'_'||MATERIALID
)SALES_LINT_COUNT 
ON PP_BASIC_INFO.ID = SALES_LINT_COUNT.ID
)PP_BI_SLAES_LC
LEFT JOIN
(
SELECT PLANTID
      ||'_'
      ||MATERIALID                           AS ID,
      CEIL(SUM(PLNMG_PLANNEDQUANTITY)/26) AS FC_AVG_WEEK
    FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK
    WHERE (PDATU_DELIV_ORDFINISHDATE BETWEEN TO_CHAR(sysdate) AND TO_CHAR(sysdate + 182))
    AND PLANTID = '5110'
    AND VERSBP_VERSION = '55'
    AND MATERIALID IN  ('1734-ARM C')
    GROUP BY MATERIALID, PLANTID ||'_' ||MATERIALID, PLANTID
)FC_AVG
ON FC_AVG.ID = PP_BI_SLAES_LC.ID
)LOCAL_STATUS
LEFT JOIN
(
SELECT ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM
FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK)
WHERE ID IN (SELECT DISTINCT
SUBSTR(VENDOR_NAME,0,4)||'_'||MATERIALID AS VENDOR_ITEM
FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND  MATERIALID IN ('1734-ARM C')
))SUPPLIER_STATUS
ON SUPPLIER_STATUS.ID = LOCAL_STATUS.ID;

-----------------------------------------------------------------------------------------------------------------
SELECT  MATERIALID
      ||'_'
      ||DIRECT_SHIP_PLANT            AS ID,
  MATERIALID,
  CURRENT_SERIES,
  DIRECT_SHIP_PLANT
FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND EXIT IN(
SELECT MATERIALID FROM CATALOG_NODASH_MATERIAL WHERE CATALOG_STRING2 IN ('1734ARM','1734EP24DC','1734IE2C')
);

SELECT  
  MATERIALID
FROM INV_SAP_PP_MVKE
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND MATERIALID IN(
SELECT MATERIALID FROM CATALOG_NODASH_MATERIAL WHERE CATALOG_STRING2 IN ('1734ARM','1734EP24DC','1734IE2C')
);



SELECT * FROM
(
SELECT 
PP_BI_SLAES_LC.ID AS ID,
PP_BI_SLAES_LC.MATERIALID AS MATERIALID,
PP_BI_SLAES_LC.PLANTID AS PLANTID,
PP_BI_SLAES_LC.MAT_DESC AS MAT_DESC,
PP_BI_SLAES_LC.SAFETY_STK AS SAFETY_STK,
PP_BI_SLAES_LC.LOT_SIZE AS LOT_SIZE,
PP_BI_SLAES_LC.OH_QTY AS OH_QTY,
PP_BI_SLAES_LC.UNIT_COST AS UNIT_COST,
PP_BI_SLAES_LC.OH_$$ AS OH_$$,
PP_BI_SLAES_LC.MAX_INV_$$ AS MAX_INV_$$,
PP_BI_SLAES_LC.OH_WOS AS OH_WOS,
PP_BI_SLAES_LC.PLAN_INV_WOS AS PLAN_INV_WOS,
PP_BI_SLAES_LC.PROD_BU AS PROD_BU,
PP_BI_SLAES_LC.STRATEGY_GRP AS STRATEGY_GRP,
SUBSTR(PP_BI_SLAES_LC.VENDOR_NAME,0,4)||'_'||PP_BI_SLAES_LC.MATERIALID AS VENDOR_ITEM,
PP_BI_SLAES_LC.LOT_ROUNDING_VALUE AS LOT_ROUNDING_VALUE,
PP_BI_SLAES_LC.AVG26_USAGE_QTY AS AVG26_USAGE_QTY,
PP_BI_SLAES_LC.USE_LINES_COUNT_26WEEKS  AS USE_LINES_COUNT_26WEEKS,
FC_AVG.FC_AVG_WEEK AS FC_AVG_WEEK,
PP_BI_SLAES_LC.GRT AS GRT,
PP_BI_SLAES_LC.PDT AS PDT,
PP_BI_SLAES_LC.MEINS_ISSUE_UOM AS MEINS_ISSUE_UOM,
PP_BI_SLAES_LC.MATL_TYPE_MTART AS MATL_TYPE_MTART
FROM
(
SELECT 
PP_BASIC_INFO.ID AS ID,
PP_BASIC_INFO.MATERIALID AS MATERIALID,
PP_BASIC_INFO.PLANTID AS PLANTID,
PP_BASIC_INFO.MAT_DESC AS MAT_DESC,
PP_BASIC_INFO.SAFETY_STK AS SAFETY_STK,
PP_BASIC_INFO.LOT_SIZE AS LOT_SIZE,
PP_BASIC_INFO.OH_QTY AS OH_QTY,
PP_BASIC_INFO.UNIT_COST AS UNIT_COST,
PP_BASIC_INFO.OH_$$ AS OH_$$,
PP_BASIC_INFO.MAX_INV_$$ AS MAX_INV_$$,
PP_BASIC_INFO.OH_WOS AS OH_WOS,
PP_BASIC_INFO.PLAN_INV_WOS AS PLAN_INV_WOS,
PP_BASIC_INFO.PROD_BU AS PROD_BU,
PP_BASIC_INFO.STRATEGY_GRP AS STRATEGY_GRP,
PP_BASIC_INFO.MRP_TYPE AS MRP_TYPE,
PP_BASIC_INFO.VENDOR_NAME AS VENDOR_NAME,
PP_BASIC_INFO.LOT_ROUNDING_VALUE AS LOT_ROUNDING_VALUE,
PP_BASIC_INFO.AVG26_USAGE_QTY AS AVG26_USAGE_QTY,
SALES_LINT_COUNT.LINE_COUNT  AS USE_LINES_COUNT_26WEEKS,
PP_BASIC_INFO.GRT AS GRT,
PP_BASIC_INFO.PDT AS PDT,
PP_BASIC_INFO.MEINS_ISSUE_UOM AS MEINS_ISSUE_UOM,
PP_BASIC_INFO.MATL_TYPE_MTART AS MATL_TYPE_MTART
FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
MAT_DESC,
SAFETY_STK,
LOT_SIZE,
OH_QTY,
UNIT_COST,
OH_$$,
MAX_INV_$$,
OH_WOS,
PLAN_INV_WOS,
PROD_BU,
STRATEGY_GRP,
MRP_TYPE,
VENDOR_NAME,
LOT_ROUNDING_VALUE,
AVG26_USAGE_QTY,
GRT,
PDT,
MEINS_ISSUE_UOM,
MATL_TYPE_MTART  FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND  MATERIALID IN (SELECT  
  MATERIALID
FROM INV_SAP_PP_MVKE
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND MATERIALID IN(
SELECT MATERIALID FROM CATALOG_NODASH_MATERIAL WHERE CATALOG_STRING2 IN ('1734ARM','1734EP24DC','1734IE2C')
))
)PP_BASIC_INFO

LEFT JOIN

(
SELECT 
PLANTID||'_'||MATERIALID AS ID,
(SUM(PLANTID)/PLANTID) AS LINE_COUNT
FROM DWQ$LIBRARIAN.INV_SAP_SALES_HST@ROCKWELL_DBLINK
WHERE MATERIALID    IN  (SELECT  
  MATERIALID
FROM INV_SAP_PP_MVKE
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND MATERIALID IN(
SELECT MATERIALID FROM CATALOG_NODASH_MATERIAL WHERE CATALOG_STRING2 IN ('1734ARM','1734EP24DC','1734IE2C')
))
AND PLANTID          = '5110'
AND COMMITTEDDATE BETWEEN TO_CHAR(sysdate - 182) AND TO_CHAR(sysdate)
GROUP BY MATERIALID, PLANTID,PLANTID||'_'||MATERIALID

)SALES_LINT_COUNT 
ON PP_BASIC_INFO.ID = SALES_LINT_COUNT.ID

)PP_BI_SLAES_LC


LEFT JOIN

(
SELECT PLANTID
      ||'_'
      ||MATERIALID                           AS ID,
      CEIL(SUM(PLNMG_PLANNEDQUANTITY)/26) AS FC_AVG_WEEK
    FROM DWQ$LIBRARIAN.INV_SAP_PP_FRCST_PBIM_PBED@ROCKWELL_DBLINK
    WHERE (PDATU_DELIV_ORDFINISHDATE BETWEEN TO_CHAR(sysdate) AND TO_CHAR(sysdate + 182))
    AND PLANTID = '5110'
    AND VERSBP_VERSION = '55'
    AND MATERIALID IN  (SELECT  
  MATERIALID
FROM INV_SAP_PP_MVKE
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND MATERIALID IN(
SELECT MATERIALID FROM CATALOG_NODASH_MATERIAL WHERE CATALOG_STRING2 IN ('1734ARM','1734EP24DC','1734IE2C')
))
    GROUP BY MATERIALID, PLANTID ||'_' ||MATERIALID, PLANTID
)FC_AVG

ON FC_AVG.ID = PP_BI_SLAES_LC.ID
)LOCAL_STATUS


LEFT JOIN


(
SELECT ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM
FROM
(SELECT 
PLANTID||'_'||MATERIALID AS ID,
MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK)
WHERE ID IN (SELECT DISTINCT
SUBSTR(VENDOR_NAME,0,4)||'_'||MATERIALID AS VENDOR_ITEM
FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '5110' AND  MATERIALID IN ()
)

)SUPPLIER_STATUS
ON SUPPLIER_STATUS.ID = LOCAL_STATUS.ID;


------Split item process and supplier, local data process in sql.
--1. Process Item and return back right material. After that, query again..

SELECT  
  MATERIALID
FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
WHERE CURRENT_SERIES   = 'X' AND DIRECT_SHIP_PLANT = '5110' AND MATERIALID IN(
SELECT MATERIALID FROM CATALOG_NODASH_MATERIAL WHERE CATALOG_STRING2 IN ('1734ARM','1734EP24DC','1734IE2C')
);


























































-------------------------------------------------------------------------
---CLX 
CREATE TABLE INV_SAP_PP_MVKE_X_CURRENT AS
SELECT  MATERIALID
      ||'_'
      ||DIRECT_SHIP_PLANT            AS ID,
  MATERIALID,
  CURRENT_SERIES,
  DIRECT_SHIP_PLANT
FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
WHERE CURRENT_SERIES   = 'X';
SELECT * FROM INV_SAP_PP_MVKE;

SELECT  MATERIALID
      ||'_'
      ||DIRECT_SHIP_PLANT            AS ID,
  MATERIALID,
  CURRENT_SERIES,
  DIRECT_SHIP_PLANT
FROM DWQ$LIBRARIAN.INV_SAP_PP_MVKE@ROCKWELL_DBLINK
WHERE CURRENT_SERIES   = 'X' AND MATERIALID IN ('1756-A10 B',
'1756-PB72 C',
'PN-109108',
'PN-98690',
'PN-184727',
'PN-52231',
'PN-171228',
'PN-52785',
'PN-85066',
'PN-80689',
'PN-12196',
'PN-81193',
'PN-80690',
'PN-82262',
'PN-81194',
'PN-80691',
'PN-55608',
'PN-75008',
'74106-851-51',
'PN-55610',
'PN-42427',
'PN-42426',
'PN-164066',
'PN-49876',
'74106-870-51',
'PN-137681',
'1734-OE4C C',
'PN-130651',
'PN-25132',
'1734-OB8E C',
'PN-31815',
'PN-81192',
'1756-PA75 B',
'PN-114257',
'PN-184723',
'1734-OB8E C',
'PN-130651',
'1734-OE2V C',
'1734-OE4C C',
'1734-IE2V C',
'1734-IE2C C',
'1734-VHSC24 C',
'1734-ARM C',
'PN-137681',
'1734-SSI C',
'1734-EP24DC B',
'1734-TB A',
'PN-12324',
'PN-55612',
'PN-12309',
'PN-42424',
'PN-42400',
'350325-A06',
'387985-A01',
'PN-12151',
'74106-845-51',
'PN-75005',
'PN-83542',
'PN-85064',
'PN-81191',
'PN-80688',
'PN-83545',
'PN-85068',
'PN-46293',
'PN-46252',
'PN-90602',
'PN-46250',
'PN-90600',
'PN-81198',
'PN-80692',
'1734-OB8 C',
'PN-25132',
'PN-31815');
SELECT * FROM INV_SAP_PP_MVKE;


----FETCH PLANT INFO AND PLANTID
CREATE TABLE INV_SAP_VENDOR_PLANT_INFO AS
SELECT * FROM DWQ$LIBRARIAN.INV_SAP_VENDOR_PLANT_INFO@ROCKWELL_DBLINK;    
        
SELECT LAST_REVIEW,
PROC_TYPE,
MATERIALID,
PLANTID,
MAT_DESC,
SAFETY_STK,
LOT_SIZE,
OH_QTY,
UNIT_COST,
OH_$$,
MAX_INV_$$,
OH_WOS,
PLAN_INV_WOS,
PROD_BU,
PROD_FAM,
PROD_HIERARCHY,
MRP_CONTROLLER,
PURCH_GROUP,
STRATEGY_GRP,
MRP_TYPE,
SP_MATL_STAT_MMSTA,
SPC_PROC_KEY_SOBSL,
VENDOR_NAME,
LOT_ROUNDING_VALUE,
AVG52_USAGE_QTY,
STDEV52_USAGE,
AVG26_USAGE_QTY,
STDEV26_USAGE,
AVG13_USAGE_QTY,
STDEV13_USAGE,
Q1_LINES,
Q2_LINES,
Q3_LINES,
Q4_LINES,
Q1_FREQ_COUNT,
Q2_FREQ_COUNT,
Q3_FREQ_COUNT,
Q4_FREQ_COUNT,
GRT,
PDT,
MEINS_ISSUE_UOM,
PURCH_GROUP_EKGRP,
MATL_TYPE_MTART  FROM INV_SAP_PP_OPTIMIZATION WHERE PLANTID = '5110' AND      
MATERIALID IN ('1756-A10 B',
'1756-PB72 C',
'PN-109108',
'PN-98690',
'PN-184727',
'PN-52231',
'PN-171228',
'PN-52785',
'PN-85066',
'PN-80689',
'PN-12196',
'PN-81193',
'PN-80690',
'PN-82262',
'PN-81194',
'PN-80691',
'PN-55608',
'PN-75008',
'74106-851-51',
'PN-55610',
'PN-42427',
'PN-42426',
'PN-164066',
'PN-49876',
'74106-870-51',
'PN-137681',
'1734-OE4C C',
'PN-130651',
'PN-25132',
'1734-OB8E C',
'PN-31815',
'PN-81192',
'1756-PA75 B',
'PN-114257',
'PN-184723',
'1734-OB8E C',
'PN-130651',
'1734-OE2V C',
'1734-OE4C C',
'1734-IE2V C',
'1734-IE2C C',
'1734-VHSC24 C',
'1734-ARM C',
'PN-137681',
'1734-SSI C',
'1734-EP24DC B',
'1734-TB A',
'PN-12324',
'PN-55612',
'PN-12309',
'PN-42424',
'PN-42400',
'350325-A06',
'387985-A01',
'PN-12151',
'74106-845-51',
'PN-75005',
'PN-83542',
'PN-85064',
'PN-81191',
'PN-80688',
'PN-83545',
'PN-85068',
'PN-46293',
'PN-46252',
'PN-90602',
'PN-46250',
'PN-90600',
'PN-81198',
'PN-80692',
'1734-OB8 C',
'PN-25132',
'PN-31815');  
        
        
---Select Vendor Info
--1090
DROP TABLE INV_SAP_PP_OPTIMIZATION_1090;
SELECT * FROM INV_SAP_PP_OPTIMIZATION_1090;
CREATE TABLE INV_SAP_PP_OPTIMIZATION_1090 AS
SELECT MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM
FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '1090' AND      
MATERIALID IN
('PN-25132',
'PN-12309',
'1734-ARM C',
'1734-EP24DC B',
'PN-81193',
'PN-80691',
'PN-81191',
'74106-845-51',
'PN-98690',
'PN-46293',
'74106-870-51',
'PN-85064',
'PN-184727',
'PN-82262',
'PN-80688',
'1734-OE4C C',
'PN-83545',
'PN-85066',
'1734-IE2V C',
'1734-SSI C',
'PN-90600',
'PN-90602',
'PN-81194',
'PN-109108',
'PN-80690',
'PN-49876',
'1734-OE2V C',
'PN-85068',
'PN-52231',
'1734-OB8 C',
'1756-PB72 C',
'PN-80689',
'PN-114257',
'PN-184723',
'PN-81192',
'PN-83542',
'PN-171228',
'1734-OB8E C',
'1734-TB A',
'350325-A06',
'1734-VHSC24 C',
'PN-55608',
'PN-46250',
'1756-PA75 B',
'PN-130651',
'387985-A01',
'1734-IE2C C',
'PN-46252');
        
--1180
DROP TABLE INV_SAP_PP_OPTIMIZATION_1180;
SELECT * FROM INV_SAP_PP_OPTIMIZATION_1180;
CREATE TABLE INV_SAP_PP_OPTIMIZATION_1180 AS
SELECT MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '1180' AND      
MATERIALID IN
('PN-80692',
'1756-A10 B',
'PN-52785',
'PN-55612',
'74106-851-51',
'PN-42424',
'PN-55610',
'PN-75005',
'PN-12151',
'PN-12324',
'PN-75008',
'PN-42426',
'PN-12196',
'PN-42427');
        
--4000
SELECT MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '4000' AND      
MATERIALID IN
('PN-81198','PN-137681'
); 


--1020
SELECT MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '1020' AND      
MATERIALID IN
('PN-31815'); 

--1000
SELECT MATERIALID,
PLANTID,
SAFETY_STK,
OH_QTY,
STRATEGY_GRP,
GRT,
PDT,
MEINS_ISSUE_UOM FROM DWQ$LIBRARIAN.INV_SAP_PP_OPTIMIZATION@ROCKWELL_DBLINK WHERE PLANTID = '1100' AND      
MATERIALID IN
('PN-42400'); 

--------------------------------------26 weeks Usage Lines Count----------------------------
SELECT MATERIAL,
  (SUM(plant)/5110) AS LINE_COUNT,
  plant
FROM INV_SAP_SALES_VBAK_VBAP_VBUP
WHERE MATERIAL    IN ('1756-A10 B',
'1756-PB72 C',
'PN-109108',
'PN-98690',
'PN-184727',
'PN-52231',
'PN-171228',
'PN-52785',
'PN-85066',
'PN-80689',
'PN-12196',
'PN-81193',
'PN-80690',
'PN-82262',
'PN-81194',
'PN-80691',
'PN-55608',
'PN-75008',
'74106-851-51',
'PN-55610',
'PN-42427',
'PN-42426',
'PN-164066',
'PN-49876',
'74106-870-51',
'PN-137681',
'1734-OE4C C',
'PN-130651',
'PN-25132',
'1734-OB8E C',
'PN-31815',
'PN-81192',
'1756-PA75 B',
'PN-114257',
'PN-184723',
'1734-OB8E C',
'PN-130651',
'1734-OE2V C',
'1734-OE4C C',
'1734-IE2V C',
'1734-IE2C C',
'1734-VHSC24 C',
'1734-ARM C',
'PN-137681',
'1734-SSI C',
'1734-EP24DC B',
'1734-TB A',
'PN-12324',
'PN-55612',
'PN-12309',
'PN-42424',
'PN-42400',
'350325-A06',
'387985-A01',
'PN-12151',
'74106-845-51',
'PN-75005',
'PN-83542',
'PN-85064',
'PN-81191',
'PN-80688',
'PN-83545',
'PN-85068',
'PN-46293',
'PN-46252',
'PN-90602',
'PN-46250',
'PN-90600',
'PN-81198',
'PN-80692',
'1734-OB8 C',
'PN-25132',
'PN-31815')
AND PLANT          = '5110'
AND LINECREATEDATE > SYSDATE - 182
GROUP BY MATERIAL,
  plant;
